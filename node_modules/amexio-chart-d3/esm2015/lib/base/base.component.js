/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import { Input, Output, EventEmitter } from "@angular/core";
export class AmexioD3BaseChartComponent {
    /**
     * @param {?} charttype
     */
    constructor(charttype) {
        this.onLegendClick = new EventEmitter();
        this.onChartClick = new EventEmitter();
        this.onLineClick = new EventEmitter();
        this.drillableEvent = new EventEmitter();
        this.legend = true;
        this.height = "300";
        this.width = "300";
        this.title = "";
        this.possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcddefghijklmonpqrstuvwxyz";
        this.colorIndex = 0;
        this.colors = [];
        this.charttype = charttype;
        this.predefinedcolors = ["#3366cc", "#dc3912", "#ff9900", "#109618", "#990099", "#0099c6", "#dd4477", "#66aa00", "#b82e2e", "#316395", "#994499", "#22aa99", "#aaaa11", "#6633cc", "#e67300", "#8b0707", "#651067", "#329262", "#5574a6", "#3b3eac"];
        this.componentId = this.charttype + "-" + this.generateId();
    }
    /**
     * @return {?}
     */
    initializeData() {
        this.data.forEach(element => {
            element.color = this.getColor(element);
        });
    }
    /**
     * @param {?} data
     * @param {?} drillablekeys
     * @return {?}
     */
    getMultipleDrillbleKeyData(data, drillablekeys) {
        /** @type {?} */
        let nodeObject = {};
        if (data) {
            for (let index = 0; index < drillablekeys.length; index++) {
                /** @type {?} */
                let element = drillablekeys[index];
                for (let [key, value] of Object.entries(data)) {
                    if (key == element) {
                        nodeObject[key] = value;
                    }
                }
                ;
            }
            return nodeObject;
        }
    }
    /**
     * @return {?}
     */
    generateId() {
        /** @type {?} */
        let id = "";
        for (let i = 0; i < 5; i++) {
            id = id + this.possible
                .charAt(Math.floor(Math.random() * this.possible.length));
        }
        id = id + "-" + new Date().getTime();
        return id;
    }
    /**
     * @param {?} object
     * @return {?}
     */
    getColor(object) {
        if (object.color) {
            return object.color;
        }
        else if (this.colors.length > this.colorIndex) {
            /** @type {?} */
            const color = this.colors[this.colorIndex];
            this.colorIndex++;
            return color;
        }
        else if ((this.colors.length > 0) && (this.colors.length <= this.colorIndex)) {
            this.colorIndex = 0;
            /** @type {?} */
            const color = this.colors[this.colorIndex];
            return color;
        }
        else {
            /** @type {?} */
            const color = this.predefinedcolors[this.colorIndex];
            this.colorIndex++;
            return color;
        }
    }
    /**
     * @param {?} node
     * @return {?}
     */
    legendClick(node) {
        this.onLegendClick.emit(node);
    }
    /**
     * @param {?} node
     * @return {?}
     */
    chartClick(node) {
        this.onChartClick.emit(node);
    }
    /**
     * @param {?} node
     * @return {?}
     */
    comboLineClick(node) {
        this.onLineClick.emit(node);
    }
    /**
     * @param {?} ref
     * @param {?} node
     * @param {?} event
     * @return {?}
     */
    fordrillableClick(ref, node, event) {
        this.drillableEvent.emit({ ref: ref, node: node, event: event });
    }
    /**
     * @param {?} d3
     * @return {?}
     */
    toolTip(d3) {
        return d3.select("body")
            .append("div")
            .attr('id', 'tooltipid')
            .attr('class', 'amexiod3tooltip')
            .style("position", "absolute")
            .style("z-index", "10")
            .style("visibility", "hidden");
    }
    /**
     * @param {?} tooltipdata
     * @return {?}
     */
    toolTipContent(tooltipdata) {
        /** @type {?} */
        let tooltiphtml = "<table>";
        for (const key in tooltipdata) {
            if (tooltipdata.hasOwnProperty(key)) {
                /** @type {?} */
                const value = tooltipdata[key];
                tooltiphtml = tooltiphtml + "<tr>";
                //------------------
                //   tooltiphtml = tooltiphtml + "<td>";
                //   tooltiphtml = tooltiphtml + key+':';
                //   tooltiphtml = tooltiphtml + "</td>";
                //------------------
                tooltiphtml = tooltiphtml + "<td>";
                tooltiphtml = tooltiphtml + value;
                tooltiphtml = tooltiphtml + "</td>";
                tooltiphtml = tooltiphtml + "</tr>";
            }
        }
        tooltiphtml = tooltiphtml + "</table>";
        return tooltiphtml;
    }
    /**
     * @param {?} legend
     * @param {?} xaxis
     * @param {?} yaxis
     * @return {?}
     */
    toolTipWithLegendandAxis(legend, xaxis, yaxis) {
        /** @type {?} */
        let tooltiphtml = "<div>";
        tooltiphtml = tooltiphtml + "<b>" + xaxis + "</b>, ";
        tooltiphtml = tooltiphtml + legend + "</b> ";
        tooltiphtml = tooltiphtml + "<b>" + yaxis + "</b> ";
        tooltiphtml = tooltiphtml + "</div>";
        return tooltiphtml;
    }
    /**
     * @param {?} tooltipData
     * @return {?}
     */
    toolTipForBar(tooltipData) {
        /** @type {?} */
        let tooltiphtml = "<div>";
        for (let [key, value] of Object.entries(tooltipData)) {
            /** @type {?} */
            let sideStyle = "float:left";
            tooltiphtml = tooltiphtml + "<div>";
            tooltiphtml = tooltiphtml + "<span style =" + sideStyle + " ><b>" + key + " " + "</b>" + value + "</br></span>";
            tooltiphtml = tooltiphtml + "</div>";
        }
        return tooltiphtml;
    }
}
AmexioD3BaseChartComponent.propDecorators = {
    onLegendClick: [{ type: Output }],
    onChartClick: [{ type: Output }],
    onLineClick: [{ type: Output }],
    drillableEvent: [{ type: Output }],
    data: [{ type: Input, args: ['data',] }],
    httpurl: [{ type: Input, args: ['http-url',] }],
    httpmethod: [{ type: Input, args: ['http-method',] }],
    legend: [{ type: Input, args: ['legend',] }],
    colors: [{ type: Input, args: ['color',] }],
    height: [{ type: Input, args: ['height',] }],
    width: [{ type: Input, args: ['width',] }],
    title: [{ type: Input, args: ['title',] }]
};
if (false) {
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.onLegendClick;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.onChartClick;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.onLineClick;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.drillableEvent;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.data;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.httpurl;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.httpmethod;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.legend;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.colors;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.height;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.width;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.title;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.predefinedcolors;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.componentId;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.possible;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.colorIndex;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.charttype;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbWV4aW8tY2hhcnQtZDMvIiwic291cmNlcyI6WyJsaWIvYmFzZS9iYXNlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTVELE1BQU07Ozs7SUFzQ0YsWUFBWSxTQUFnQjtRQWxDbEIsa0JBQWEsR0FBUSxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRTdDLGlCQUFZLEdBQVEsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUU1QyxnQkFBVyxHQUFRLElBQUksWUFBWSxFQUFPLENBQUM7UUFFM0MsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBUTdCLFdBQU0sR0FBWSxJQUFJLENBQUU7UUFJeEIsV0FBTSxHQUFRLEtBQUssQ0FBQztRQUVyQixVQUFLLEdBQVMsS0FBSyxDQUFDO1FBRXBCLFVBQUssR0FBUSxFQUFFLENBQUM7UUFNdkIsYUFBUSxHQUFZLHVEQUF1RCxDQUFDO1FBRXJGLGVBQVUsR0FBVyxDQUFDLENBQUM7UUFLbkIsSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ3JQLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsR0FBSSxH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LFNBQVMsR0FBQyxZQUFZO1lBQzFCLFdBQVcsR0FBRyxXQUFXLEdBQUcsT0FBTyxDQUFDO1lBQ3ZDLFdBQVcsR0FBRyxXQUFXLEdBQUcsZUFBZSxHQUFDLFNBQVMsR0FBQyxPQUFPLEdBQUcsR0FBRyxHQUFFLEdBQUcsR0FBRSxNQUFNLEdBQUUsS0FBSyxHQUFHLGNBQWMsQ0FBQztZQUN6RyxXQUFXLEdBQUcsV0FBVyxHQUFHLFFBQVEsQ0FBQztRQUN0QyxDQUFDO1FBRUEsTUFBTSxDQUFDLFdBQVcsQ0FBQztJQUN4QixDQUFDOzs7NEJBeEtBLE1BQU07MkJBRU4sTUFBTTswQkFFTixNQUFNOzZCQUVOLE1BQU07bUJBRU4sS0FBSyxTQUFDLE1BQU07c0JBRVosS0FBSyxTQUFDLFVBQVU7eUJBRWhCLEtBQUssU0FBQyxhQUFhO3FCQUVuQixLQUFLLFNBQUMsUUFBUTtxQkFFZCxLQUFLLFNBQUMsT0FBTztxQkFFYixLQUFLLFNBQUMsUUFBUTtvQkFFZCxLQUFLLFNBQUMsT0FBTztvQkFFYixLQUFLLFNBQUMsT0FBTzs7OztJQXRCZCxtREFBdUQ7O0lBRXZELGtEQUFzRDs7SUFFdEQsaURBQXFEOztJQUVyRCxvREFBOEM7O0lBRTlDLDBDQUF5Qjs7SUFFekIsNkNBQWdDOztJQUVoQyxnREFBc0M7O0lBRXRDLDRDQUF5Qzs7SUFFekMsNENBQTRCOztJQUU1Qiw0Q0FBcUM7O0lBRXJDLDJDQUFvQzs7SUFFcEMsMkNBQWdDOztJQUVoQyxzREFBMkI7O0lBRTNCLGlEQUFxQjs7SUFFckIsOENBQXFGOztJQUVyRixnREFBdUI7O0lBRXZCLCtDQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmV4cG9ydCBjbGFzcyBBbWV4aW9EM0Jhc2VDaGFydENvbXBvbmVudHtcblxuICAgXG5cbiAgICBAT3V0cHV0KCkgb25MZWdlbmRDbGljazogYW55ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBAT3V0cHV0KCkgb25DaGFydENsaWNrOiBhbnkgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIEBPdXRwdXQoKSBvbkxpbmVDbGljazogYW55ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICBcbiAgICBAT3V0cHV0KCkgZHJpbGxhYmxlRXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgXG4gICAgQElucHV0KCdkYXRhJykgZGF0YTogYW55O1xuXG4gICAgQElucHV0KCdodHRwLXVybCcpIGh0dHB1cmw6IGFueTtcbiAgICBcbiAgICBASW5wdXQoJ2h0dHAtbWV0aG9kJykgaHR0cG1ldGhvZDogYW55O1xuXG4gICAgQElucHV0KCdsZWdlbmQnKSBsZWdlbmQ6IGJvb2xlYW4gPSB0cnVlIDtcblxuICAgIEBJbnB1dCgnY29sb3InKSBjb2xvcnM6IGFueTtcblxuICAgIEBJbnB1dCgnaGVpZ2h0JykgaGVpZ2h0OiBhbnkgPSBcIjMwMFwiO1xuXG4gICAgQElucHV0KCd3aWR0aCcpIHdpZHRoIDogYW55ID0gXCIzMDBcIjtcblxuICAgIEBJbnB1dCgndGl0bGUnKSB0aXRsZTogYW55ID0gXCJcIjtcblxuICAgIHByZWRlZmluZWRjb2xvcnM6IHN0cmluZ1tdO1xuICAgIFxuICAgIGNvbXBvbmVudElkIDogc3RyaW5nO1xuXG4gICAgcHJpdmF0ZSAgcG9zc2libGUgOiBzdHJpbmcgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGRlZmdoaWprbG1vbnBxcnN0dXZ3eHl6XCI7XG5cbiAgICBjb2xvckluZGV4OiBudW1iZXIgPSAwO1xuXG4gICAgY2hhcnR0eXBlIDogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoY2hhcnR0eXBlOnN0cmluZykge1xuICAgICAgICB0aGlzLmNvbG9ycyA9IFtdO1xuICAgICAgICB0aGlzLmNoYXJ0dHlwZSA9IGNoYXJ0dHlwZTtcbiAgICAgICAgdGhpcy5wcmVkZWZpbmVkY29sb3JzID0gW1wiIzMzNjZjY1wiLCBcIiNkYzM5MTJcIiwgXCIjZmY5OTAwXCIsIFwiIzEwOTYxOFwiLCBcIiM5OTAwOTlcIiwgXCIjMDA5OWM2XCIsIFwiI2RkNDQ3N1wiLCBcIiM2NmFhMDBcIiwgXCIjYjgyZTJlXCIsIFwiIzMxNjM5NVwiLCBcIiM5OTQ0OTlcIiwgXCIjMjJhYTk5XCIsIFwiI2FhYWExMVwiLCBcIiM2NjMzY2NcIiwgXCIjZTY3MzAwXCIsIFwiIzhiMDcwN1wiLCBcIiM2NTEwNjdcIiwgXCIjMzI5MjYyXCIsIFwiIzU1NzRhNlwiLCBcIiMzYjNlYWNcIl07XG4gICAgICAgIHRoaXMuY29tcG9uZW50SWQgPSB0aGlzLmNoYXJ0dHlwZSAgKyBcIi1cIiArIHRoaXMuZ2VuZXJhdGVJZCgpO1xuICAgIH1cbiAgXG4gICAgcHJvdGVjdGVkIGluaXRpYWxpemVEYXRhKCkge1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmRhdGEuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgICBlbGVtZW50LmNvbG9yID0gdGhpcy5nZXRDb2xvcihlbGVtZW50KTtcbiAgICAgICAgICAgfSk7XG4gICAgIH1cblxuICAgICAgcHJvdGVjdGVkIGdldE11bHRpcGxlRHJpbGxibGVLZXlEYXRhKGRhdGE6YW55LGRyaWxsYWJsZWtleXM6YW55KVxuICAgICAge1xuICAgICAgIFxuICAgICAgICAgIGxldCBub2RlT2JqZWN0PXt9O1xuICAgICAgICAgIGlmKGRhdGEpXG4gICAgICAgICAge1xuICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGRyaWxsYWJsZWtleXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgIGxldCBlbGVtZW50ID0gZHJpbGxhYmxla2V5c1tpbmRleF07XG4gICAgICAgICAgIGZvciAobGV0IFtrZXksdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PSBlbGVtZW50KSBcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZU9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBub2RlT2JqZWN0O1xuICAgICAgICAgICAgfVxuICAgICAgIFxuIH1cbiAgICAgXG4gcHJpdmF0ZSBnZW5lcmF0ZUlkKCl7XG4gICAgICAgbGV0IGlkID0gXCJcIjtcbiAgICAgICBmb3IobGV0IGkgPSAwOyBpPDU7IGkrKyl7XG4gICAgICAgIGlkID0gaWQgKyB0aGlzLnBvc3NpYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSp0aGlzLnBvc3NpYmxlLmxlbmd0aCkpO1xuICAgICAgIH1cbiAgICAgICBpZCA9IGlkICsgXCItXCIrbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgcmV0dXJuIGlkO1xuICAgIH1cblxuICAgIHByaXZhdGUgIGdldENvbG9yKG9iamVjdCA6IGFueSl7XG4gICAgICAgIGlmIChvYmplY3QuY29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3QuY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5jb2xvcnMubGVuZ3RoID4gdGhpcy5jb2xvckluZGV4KSB7XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMuY29sb3JzW3RoaXMuY29sb3JJbmRleF07XG4gICAgICAgICAgICB0aGlzLmNvbG9ySW5kZXgrKztcbiAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgodGhpcy5jb2xvcnMubGVuZ3RoID4gMCkgJiYgKHRoaXMuY29sb3JzLmxlbmd0aCA8PSB0aGlzLmNvbG9ySW5kZXgpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbG9ySW5kZXggPSAwO1xuICAgICAgICAgICAgY29uc3QgY29sb3IgPSB0aGlzLmNvbG9yc1t0aGlzLmNvbG9ySW5kZXhdO1xuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgY29sb3IgPSB0aGlzLnByZWRlZmluZWRjb2xvcnNbdGhpcy5jb2xvckluZGV4XTtcbiAgICAgICAgICAgIHRoaXMuY29sb3JJbmRleCsrO1xuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBsZWdlbmRDbGljayhub2RlOmFueSl7XG4gICAgICAgIHRoaXMub25MZWdlbmRDbGljay5lbWl0KG5vZGUpO1xuICAgIH1cblxuICAgIGNoYXJ0Q2xpY2sobm9kZTphbnkpe1xuICAgICAgICB0aGlzLm9uQ2hhcnRDbGljay5lbWl0KG5vZGUpO1xuICAgIH1cbiAgICBcbiAgICBjb21ib0xpbmVDbGljayhub2RlOiBhbnkpe1xuICAgICAgICB0aGlzLm9uTGluZUNsaWNrLmVtaXQobm9kZSk7XG4gICAgfVxuICAgIGZvcmRyaWxsYWJsZUNsaWNrKHJlZjogYW55LG5vZGU6IGFueSxldmVudDogYW55KVxuICAgICB7XG4gICAgICAgIHRoaXMuZHJpbGxhYmxlRXZlbnQuZW1pdCh7cmVmOiByZWYsbm9kZTogbm9kZSxldmVudDogZXZlbnR9KTtcbiAgICB9XG4gICAgcHJvdGVjdGVkIHRvb2xUaXAgKGQzOmFueSkgOmFueXtcbiAgICAgICByZXR1cm4gIGQzLnNlbGVjdChcImJvZHlcIilcbiAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywndG9vbHRpcGlkJylcbiAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCdhbWV4aW9kM3Rvb2x0aXAnKVxuICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIilcbiAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJ6LWluZGV4XCIsIFwiMTBcIilcbiAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJ2aXNpYmlsaXR5XCIsIFwiaGlkZGVuXCIpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCB0b29sVGlwQ29udGVudCh0b29sdGlwZGF0YTphbnkpIDphbnl7XG4gICAgICAgbGV0IHRvb2x0aXBodG1sID0gXCI8dGFibGU+XCI7XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0b29sdGlwZGF0YSkge1xuICAgICAgICBpZiAodG9vbHRpcGRhdGEuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIGNvbnN0IHZhbHVlID0gdG9vbHRpcGRhdGFba2V5XTtcbiAgICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8dHI+XCI7XG4vLy0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvLyAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyBcIjx0ZD5cIjtcbiAgICAgICAgLy8gICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsga2V5Kyc6JztcbiAgICAgICAgLy8gICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8L3RkPlwiO1xuLy8tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8dGQ+XCI7XG4gICAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIHZhbHVlO1xuICAgICAgICAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyBcIjwvdGQ+XCI7XG4gICAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPC90cj5cIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPC90YWJsZT5cIjtcblxuICAgICAgcmV0dXJuIHRvb2x0aXBodG1sO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCB0b29sVGlwV2l0aExlZ2VuZGFuZEF4aXMobGVnZW5kOiBzdHJpbmcsIHhheGlzOnN0cmluZywgeWF4aXM6IHN0cmluZykgOmFueXtcbiAgICAgICAgbGV0IHRvb2x0aXBodG1sID0gXCI8ZGl2PlwiO1xuICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8Yj5cIit4YXhpcytcIjwvYj4sIFwiO1xuICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgbGVnZW5kK1wiPC9iPiBcIjtcbiAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPGI+XCIreWF4aXMrXCI8L2I+IFwiO1xuICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgcmV0dXJuIHRvb2x0aXBodG1sO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCB0b29sVGlwRm9yQmFyKHRvb2x0aXBEYXRhOiBhbnkpOiBhbnl7XG4gICAgICAgICBsZXQgdG9vbHRpcGh0bWw9IFwiPGRpdj5cIjtcbiAgICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRvb2x0aXBEYXRhKSkge1xuICAgICAgICAgICAgbGV0IHNpZGVTdHlsZT1cImZsb2F0OmxlZnRcIjtcbiAgICAgICAgICAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyBcIjxkaXY+XCI7XG4gICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8c3BhbiBzdHlsZSA9XCIrc2lkZVN0eWxlK1wiID48Yj5cIiArIGtleSArXCIgXCIrIFwiPC9iPlwiICt2YWx1ZSArIFwiPC9icj48L3NwYW4+XCI7XG4gICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgfVxuXG4gICAgICAgICByZXR1cm4gdG9vbHRpcGh0bWw7XG4gICAgfVxuXG59Il19