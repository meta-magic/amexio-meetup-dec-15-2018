/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component } from '@angular/core';
import { ViewDrillableComponent } from '../../base/view.component';
var DrillableComponent = /** @class */ (function (_super) {
    tslib_1.__extends(DrillableComponent, _super);
    function DrillableComponent() {
        var _this = _super.call(this) || this;
        _this.mouseLocation = { left: 0, top: 0 };
        _this.componentcounter = 1;
        _this.disableFlag = false;
        return _this;
    }
    /**
     * @return {?}
     */
    DrillableComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    DrillableComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.ComponentDataArray = this.getComponentData();
        this.getData(this.ComponentDataArray);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    DrillableComponent.prototype.getData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        data.forEach(function (element) {
            if (element.level !== 1) {
                element.drillableFlag = false;
                element.drillableEvent.subscribe(function (eventdata) {
                    _this.hideUI(eventdata);
                    _this.sameLevelChart(eventdata);
                    _this.ShowUI(eventdata);
                });
            }
            else {
                _this.disableFlag = false;
                element.drillableEvent.subscribe(function (eventdata) {
                    _this.hideUI(eventdata);
                    _this.sameLevelChart(eventdata);
                    _this.ShowUI(eventdata);
                });
            }
        });
    };
    /**
     * @param {?} eventRef
     * @return {?}
     */
    DrillableComponent.prototype.hideUI = /**
     * @param {?} eventRef
     * @return {?}
     */
    function (eventRef) {
        this.ComponentDataArray.forEach(function (element) {
            if (element.level == eventRef.ref.level) {
                eventRef.ref.drillableFlag = false;
            }
        });
    };
    /**
     * @param {?} eventRef
     * @return {?}
     */
    DrillableComponent.prototype.ShowUI = /**
     * @param {?} eventRef
     * @return {?}
     */
    function (eventRef) {
        var _this = this;
        this.eventData = [];
        this.eventData = eventRef;
        this.ComponentDataArray.forEach(function (element) {
            if (eventRef.ref.target == element.level) {
                if (_this.arrayofsameLevel.length == 1) {
                    _this.disableFlag = true;
                    element.drillableFlag = true;
                    element.fetchData(eventRef.node);
                    _this.componentcounter = element.level;
                }
                else {
                    _this.contextmenuFlag = true;
                    _this.mouseLocation.left = eventRef.event.clientX;
                    _this.mouseLocation.top = eventRef.event.clientY;
                    _this.contextStyle = _this.getContextMenuStyle();
                }
            }
        });
        if (this.componentcounter == eventRef.ref.level) {
            eventRef.ref.drillableFlag = true;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DrillableComponent.prototype.previouschartClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        /** @type {?} */
        var chartLevel = this.componentcounter - 1;
        this.ComponentDataArray.forEach(function (element) {
            if (chartLevel == element.level) {
                element.drillableFlag = true;
                element.drawChart();
            }
            else if (_this.componentcounter == element.level) {
                element.drillableFlag = false;
            }
        });
        if (this.componentcounter == 2) {
            this.disableFlag = false;
        }
        this.componentcounter = chartLevel;
    };
    /**
     * @param {?} eventRef
     * @return {?}
     */
    DrillableComponent.prototype.sameLevelChart = /**
     * @param {?} eventRef
     * @return {?}
     */
    function (eventRef) {
        var _this = this;
        this.arrayofsameLevel = [];
        this.ComponentDataArray.forEach(function (element) {
            if (eventRef.ref.target == element.level) {
                _this.arrayofsameLevel = _this.arrayofsameLevel.concat(element);
            }
        });
    };
    //Method Creates style if two same targets found.
    //Method Creates style if two same targets found.
    /**
     * @return {?}
     */
    DrillableComponent.prototype.getContextMenuStyle = 
    //Method Creates style if two same targets found.
    /**
     * @return {?}
     */
    function () {
        return {
            'cursor': 'default',
            'position': 'fixed',
            'display': this.contextmenuFlag ? 'block' : 'none',
            'left': this.mouseLocation.left + 'px',
            'top': this.mouseLocation.top + 'px',
            'box-shadow': '1px 1px 2px #000000',
            'width': '15%',
        };
    };
    /**
     * @param {?} elementRef
     * @return {?}
     */
    DrillableComponent.prototype.getListPosition = /**
     * @param {?} elementRef
     * @return {?}
     */
    function (elementRef) {
        /** @type {?} */
        var height = 240;
        if ((window.screen.height - elementRef.getBoundingClientRect().bottom) < height) {
            return true;
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DrillableComponent.prototype.onContextNodeClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.componentcounter = 0;
        this.contextmenuFlag = false;
        this.eventData.ref.drillableFlag = false;
        this.disableFlag = true;
        event.drillableFlag = true;
        event.fetchData(this.eventData.node);
        this.componentcounter = event.level;
        if (this.componentcounter == this.eventData.ref.level) {
            this.eventData.ref.drillableFlag = true;
        }
    };
    /**
     * @return {?}
     */
    DrillableComponent.prototype.onCloseClick = /**
     * @return {?}
     */
    function () {
        this.contextmenuFlag = false;
    };
    DrillableComponent.decorators = [
        { type: Component, args: [{
                    selector: 'amexio-drillable',
                    template: "\n<div > \n    <ng-container *ngIf=\"disableFlag\">\n            <button type=\"button\" class=\"button\"\n             (click)=\"previouschartClick($event)\">\n             <i class=\"fa fa-arrow-left\"></i> \n             \n            </button>\n</ng-container>\n\n<ng-content></ng-content>\n\n</div>\n\n<span [ngStyle]=\"contextStyle\" >\n  <ul *ngIf=\"contextmenuFlag\" class=\"close-thik\" class=\"context-menu-list\"  >\n    <span (click)=\"onCloseClick()\" class=\"close\"><i class=\"fa fa-close\"></i></span>\n  <li (click)=\"onContextNodeClick(itemConfig)\" class=\"context-menu-list-items\" \n  *ngFor=\"let itemConfig of arrayofsameLevel\">\n  <em [ngStyle]=\"{'padding-left': itemConfig.icon ? '5px':'19px'}\"></em>\n  <span style=\"white-space: nowrap;display: inline ; padding-left:5px\">{{itemConfig.title}}\n  </span>\n  </li>\n  </ul>\n  </span>\n  ",
                    styles: [".button{position:relative;border:1px solid #555;font-weight:400;color:#000;padding:.5rem 1rem;text-align:center;transition-duration:.4s;text-decoration:none;overflow:hidden;cursor:pointer;border-radius:3px}.button:after{content:\"\";background:#000;display:block;position:absolute;padding-top:300%;padding-left:350%;margin-left:-20px!important;margin-top:-120%;opacity:0;transition:.8s}.button:active:after{padding:0;margin:0;opacity:1;transition:none}.context-menu-list{display:block;position:absolute;flex-direction:column;min-width:180px;cursor:pointer;max-height:150px;z-index:1;padding:10px 0;overflow-y:auto;background-color:#fff!important;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.context-menu-list .context-menu-list-items{text-decoration:none;font-size:14px!important;padding:5px;display:block}.close{float:right;padding-right:8px;cursor:pointer}"]
                },] },
    ];
    DrillableComponent.ctorParameters = function () { return []; };
    return DrillableComponent;
}(ViewDrillableComponent));
export { DrillableComponent };
if (false) {
    /** @type {?} */
    DrillableComponent.prototype.mouseLocation;
    /** @type {?} */
    DrillableComponent.prototype.contextmenuFlag;
    /** @type {?} */
    DrillableComponent.prototype.contextStyle;
    /** @type {?} */
    DrillableComponent.prototype.ComponentDataArray;
    /** @type {?} */
    DrillableComponent.prototype.componentcounter;
    /** @type {?} */
    DrillableComponent.prototype.disableFlag;
    /** @type {?} */
    DrillableComponent.prototype.arrayofsameLevel;
    /** @type {?} */
    DrillableComponent.prototype.eventData;
    /** @type {?} */
    DrillableComponent.prototype.rightClickNodeData;
    /** @type {?} */
    DrillableComponent.prototype.posixUp;
    /** @type {?} */
    DrillableComponent.prototype.levelArray;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJpbGxhYmxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FtZXhpby1jaGFydC1kMy8iLCJzb3VyY2VzIjpbImxpYi9kcmlsbGFibGUvZHJpbGxhYmxlL2RyaWxsYWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ2xELE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBUW5FO0lBZ0N3Qyw4Q0FBc0I7SUFhNUQ7UUFBQSxZQUNFLGlCQUFPLFNBQ1I7UUFiRCxtQkFBYSxHQUFrQyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDO1FBSW5FLHNCQUFnQixHQUFXLENBQUMsQ0FBQztRQUM3QixpQkFBVyxHQUFZLEtBQUssQ0FBQzs7SUFRN0IsQ0FBQzs7OztJQUVELHFDQUFROzs7SUFBUjtJQUdBLENBQUM7Ozs7SUFFRCw0Q0FBZTs7O0lBQWY7UUFFRSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDbEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUV4QyxDQUFDOzs7OztJQUNELG9DQUFPOzs7O0lBQVAsVUFBUSxJQUFTO1FBQWpCLGlCQXVCQztRQXRCQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQUEsT0FBTztZQUVsQixFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hCLE9BQU8sQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO2dCQUM5QixPQUFPLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxVQUFDLFNBQWM7b0JBQzlDLEtBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7b0JBQ3ZCLEtBQUksQ0FBQyxjQUFjLENB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LENBQUM7SUFDSCxDQUFDOzs7O0lBRUQseUNBQVk7OztJQUFaO1FBQ0UsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7SUFDL0IsQ0FBQzs7Z0JBM0xGLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsa0JBQWtCO29CQUM1QixRQUFRLEVBQUUscTJCQXlCVDtvQkFDRCxNQUFNLEVBQUUsQ0FBQyx1NUJBQXE1QixDQUFDO2lCQUNoNkI7OztJQWdLRCx5QkFBQztDQUFBLEFBN0xELENBZ0N3QyxzQkFBc0IsR0E2SjdEO1NBN0pZLGtCQUFrQjs7O0lBRTdCLDJDQUFtRTs7SUFDbkUsNkNBQXlCOztJQUN6QiwwQ0FBa0I7O0lBQ2xCLGdEQUF1Qjs7SUFDdkIsOENBQTZCOztJQUM3Qix5Q0FBNkI7O0lBQzdCLDhDQUFzQjs7SUFDdEIsdUNBQWU7O0lBQ2YsZ0RBQXdCOztJQUN4QixxQ0FBaUI7O0lBQ2pCLHdDQUFnQiIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFZpZXdEcmlsbGFibGVDb21wb25lbnQgfSBmcm9tICcuLi8uLi9iYXNlL3ZpZXcuY29tcG9uZW50JztcblxuaW1wb3J0IHtcbiAgQWZ0ZXJDb250ZW50SW5pdCwgQWZ0ZXJWaWV3SW5pdCwgQ29udGVudENoaWxkcmVuLFxuICBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPdXRwdXQsIFF1ZXJ5TGlzdCwgVmlld0NoaWxkLFxuICBWaWV3Q2hpbGRyZW5cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIb3N0TGlzdGVuZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2FtZXhpby1kcmlsbGFibGUnLFxuICB0ZW1wbGF0ZTogYFxuPGRpdiA+IFxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJkaXNhYmxlRmxhZ1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidXR0b25cIlxuICAgICAgICAgICAgIChjbGljayk9XCJwcmV2aW91c2NoYXJ0Q2xpY2soJGV2ZW50KVwiPlxuICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtYXJyb3ctbGVmdFwiPjwvaT4gXG4gICAgICAgICAgICAgXG4gICAgICAgICAgICA8L2J1dHRvbj5cbjwvbmctY29udGFpbmVyPlxuXG48bmctY29udGVudD48L25nLWNvbnRlbnQ+XG5cbjwvZGl2PlxuXG48c3BhbiBbbmdTdHlsZV09XCJjb250ZXh0U3R5bGVcIiA+XG4gIDx1bCAqbmdJZj1cImNvbnRleHRtZW51RmxhZ1wiIGNsYXNzPVwiY2xvc2UtdGhpa1wiIGNsYXNzPVwiY29udGV4dC1tZW51LWxpc3RcIiAgPlxuICAgIDxzcGFuIChjbGljayk9XCJvbkNsb3NlQ2xpY2soKVwiIGNsYXNzPVwiY2xvc2VcIj48aSBjbGFzcz1cImZhIGZhLWNsb3NlXCI+PC9pPjwvc3Bhbj5cbiAgPGxpIChjbGljayk9XCJvbkNvbnRleHROb2RlQ2xpY2soaXRlbUNvbmZpZylcIiBjbGFzcz1cImNvbnRleHQtbWVudS1saXN0LWl0ZW1zXCIgXG4gICpuZ0Zvcj1cImxldCBpdGVtQ29uZmlnIG9mIGFycmF5b2ZzYW1lTGV2ZWxcIj5cbiAgPGVtIFtuZ1N0eWxlXT1cInsncGFkZGluZy1sZWZ0JzogaXRlbUNvbmZpZy5pY29uID8gJzVweCc6JzE5cHgnfVwiPjwvZW0+XG4gIDxzcGFuIHN0eWxlPVwid2hpdGUtc3BhY2U6IG5vd3JhcDtkaXNwbGF5OiBpbmxpbmUgOyBwYWRkaW5nLWxlZnQ6NXB4XCI+e3tpdGVtQ29uZmlnLnRpdGxlfX1cbiAgPC9zcGFuPlxuICA8L2xpPlxuICA8L3VsPlxuICA8L3NwYW4+XG4gIGAsXG4gIHN0eWxlczogW2AuYnV0dG9ue3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlcjoxcHggc29saWQgIzU1NTtmb250LXdlaWdodDo0MDA7Y29sb3I6IzAwMDtwYWRkaW5nOi41cmVtIDFyZW07dGV4dC1hbGlnbjpjZW50ZXI7dHJhbnNpdGlvbi1kdXJhdGlvbjouNHM7dGV4dC1kZWNvcmF0aW9uOm5vbmU7b3ZlcmZsb3c6aGlkZGVuO2N1cnNvcjpwb2ludGVyO2JvcmRlci1yYWRpdXM6M3B4fS5idXR0b246YWZ0ZXJ7Y29udGVudDpcIlwiO2JhY2tncm91bmQ6IzAwMDtkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3BhZGRpbmctdG9wOjMwMCU7cGFkZGluZy1sZWZ0OjM1MCU7bWFyZ2luLWxlZnQ6LTIwcHghaW1wb3J0YW50O21hcmdpbi10b3A6LTEyMCU7b3BhY2l0eTowO3RyYW5zaXRpb246LjhzfS5idXR0b246YWN0aXZlOmFmdGVye3BhZGRpbmc6MDttYXJnaW46MDtvcGFjaXR5OjE7dHJhbnNpdGlvbjpub25lfS5jb250ZXh0LW1lbnUtbGlzdHtkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjttaW4td2lkdGg6MTgwcHg7Y3Vyc29yOnBvaW50ZXI7bWF4LWhlaWdodDoxNTBweDt6LWluZGV4OjE7cGFkZGluZzoxMHB4IDA7b3ZlcmZsb3cteTphdXRvO2JhY2tncm91bmQtY29sb3I6I2ZmZiFpbXBvcnRhbnQ7Ym94LXNoYWRvdzowIDVweCA1cHggLTNweCByZ2JhKDAsMCwwLC4yKSwwIDhweCAxMHB4IDFweCByZ2JhKDAsMCwwLC4xNCksMCAzcHggMTRweCAycHggcmdiYSgwLDAsMCwuMTIpfS5jb250ZXh0LW1lbnUtbGlzdCAuY29udGV4dC1tZW51LWxpc3QtaXRlbXN7dGV4dC1kZWNvcmF0aW9uOm5vbmU7Zm9udC1zaXplOjE0cHghaW1wb3J0YW50O3BhZGRpbmc6NXB4O2Rpc3BsYXk6YmxvY2t9LmNsb3Nle2Zsb2F0OnJpZ2h0O3BhZGRpbmctcmlnaHQ6OHB4O2N1cnNvcjpwb2ludGVyfWBdXG59KVxuXG5cbmV4cG9ydCBjbGFzcyBEcmlsbGFibGVDb21wb25lbnQgZXh0ZW5kcyBWaWV3RHJpbGxhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICBtb3VzZUxvY2F0aW9uOiB7IGxlZnQ6IG51bWJlcjsgdG9wOiBudW1iZXIgfSA9IHsgbGVmdDogMCwgdG9wOiAwIH07XG4gIGNvbnRleHRtZW51RmxhZzogYm9vbGVhbjtcbiAgY29udGV4dFN0eWxlOiBhbnk7XG4gIENvbXBvbmVudERhdGFBcnJheTogYW55XG4gIGNvbXBvbmVudGNvdW50ZXI6IG51bWJlciA9IDE7XG4gIGRpc2FibGVGbGFnOiBib29sZWFuID0gZmFsc2U7XG4gIGFycmF5b2ZzYW1lTGV2ZWw6IGFueTtcbiAgZXZlbnREYXRhOiBhbnk7XG4gIHJpZ2h0Q2xpY2tOb2RlRGF0YTogYW55O1xuICBwb3NpeFVwOiBib29sZWFuO1xuICBsZXZlbEFycmF5OiBhbnk7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcblxuXG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG5cbiAgICB0aGlzLkNvbXBvbmVudERhdGFBcnJheSA9IHRoaXMuZ2V0Q29tcG9uZW50RGF0YSgpO1xuICAgIHRoaXMuZ2V0RGF0YSh0aGlzLkNvbXBvbmVudERhdGFBcnJheSk7XG5cbiAgfVxuICBnZXREYXRhKGRhdGE6IGFueSkge1xuICAgIGRhdGEuZm9yRWFjaChlbGVtZW50ID0+IHtcblxuICAgICAgaWYgKGVsZW1lbnQubGV2ZWwgIT09IDEpIHtcbiAgICAgICAgZWxlbWVudC5kcmlsbGFibGVGbGFnID0gZmFsc2U7XG4gICAgICAgIGVsZW1lbnQuZHJpbGxhYmxlRXZlbnQuc3Vic2NyaWJlKChldmVudGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuaGlkZVVJKGV2ZW50ZGF0YSk7XG4gICAgICAgICAgdGhpcy5zYW1lTGV2ZWxDaGFydChldmVudGRhdGEpO1xuICAgICAgICAgIHRoaXMuU2hvd1VJKGV2ZW50ZGF0YSk7XG5cblxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMuZGlzYWJsZUZsYWcgPSBmYWxzZTtcbiAgICAgICAgZWxlbWVudC5kcmlsbGFibGVFdmVudC5zdWJzY3JpYmUoKGV2ZW50ZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgdGhpcy5oaWRlVUkoZXZlbnRkYXRhKTtcbiAgICAgICAgICB0aGlzLnNhbWVMZXZlbENoYXJ0KGV2ZW50ZGF0YSk7XG4gICAgICAgICAgdGhpcy5TaG93VUkoZXZlbnRkYXRhKTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KTtcblxuICB9XG5cbiAgaGlkZVVJKGV2ZW50UmVmOiBhbnkpIHtcbiAgICB0aGlzLkNvbXBvbmVudERhdGFBcnJheS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgaWYgKGVsZW1lbnQubGV2ZWwgPT0gZXZlbnRSZWYucmVmLmxldmVsKSB7XG4gICAgICAgIGV2ZW50UmVmLnJlZi5kcmlsbGFibGVGbGFnID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfVxuXG4gIFNob3dVSShldmVudFJlZjogYW55KSB7XG4gICAgdGhpcy5ldmVudERhdGEgPSBbXTtcbiAgICB0aGlzLmV2ZW50RGF0YSA9IGV2ZW50UmVmO1xuICAgIHRoaXMuQ29tcG9uZW50RGF0YUFycmF5LmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICBpZiAoZXZlbnRSZWYucmVmLnRhcmdldCA9PSBlbGVtZW50LmxldmVsKSB7XG4gICAgICAgIGlmICh0aGlzLmFycmF5b2ZzYW1lTGV2ZWwubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICB0aGlzLmRpc2FibGVGbGFnID0gdHJ1ZTtcbiAgICAgICAgICBlbGVtZW50LmRyaWxsYWJsZUZsYWcgPSB0cnVlO1xuICAgICAgICAgIGVsZW1lbnQuZmV0Y2hEYXRhKGV2ZW50UmVmLm5vZGUpO1xuICAgICAgICAgIHRoaXMuY29tcG9uZW50Y291bnRlciA9IGVsZW1lbnQubGV2ZWw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5jb250ZXh0bWVudUZsYWcgPSB0cnVlO1xuICAgICAgICAgIHRoaXMubW91c2VMb2NhdGlvbi5sZWZ0ID0gZXZlbnRSZWYuZXZlbnQuY2xpZW50WDtcbiAgICAgICAgICB0aGlzLm1vdXNlTG9jYXRpb24udG9wID0gZXZlbnRSZWYuZXZlbnQuY2xpZW50WTtcbiAgICAgICAgICB0aGlzLmNvbnRleHRTdHlsZSA9IHRoaXMuZ2V0Q29udGV4dE1lbnVTdHlsZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIGlmICh0aGlzLmNvbXBvbmVudGNvdW50ZXIgPT0gZXZlbnRSZWYucmVmLmxldmVsKSB7XG4gICAgICBldmVudFJlZi5yZWYuZHJpbGxhYmxlRmxhZyA9IHRydWU7XG4gICAgfVxuXG4gIH1cbiAgcHJldmlvdXNjaGFydENsaWNrKGV2ZW50OiBhbnkpIHtcbiAgICBsZXQgY2hhcnRMZXZlbCA9IHRoaXMuY29tcG9uZW50Y291bnRlciAtIDE7XG4gICAgdGhpcy5Db21wb25lbnREYXRhQXJyYXkuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgIGlmIChjaGFydExldmVsID09IGVsZW1lbnQubGV2ZWwpIHtcbiAgICAgICAgZWxlbWVudC5kcmlsbGFibGVGbGFnID0gdHJ1ZTtcbiAgICAgICAgZWxlbWVudC5kcmF3Q2hhcnQoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5jb21wb25lbnRjb3VudGVyID09IGVsZW1lbnQubGV2ZWwpIHtcbiAgICAgICAgZWxlbWVudC5kcmlsbGFibGVGbGFnID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHRoaXMuY29tcG9uZW50Y291bnRlciA9PSAyKSB7XG4gICAgICB0aGlzLmRpc2FibGVGbGFnID0gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuY29tcG9uZW50Y291bnRlciA9IGNoYXJ0TGV2ZWw7XG4gIH1cblxuXG4gIHNhbWVMZXZlbENoYXJ0KGV2ZW50UmVmOiBhbnkpIHtcbiAgXG4gICAgdGhpcy5hcnJheW9mc2FtZUxldmVsID0gW107XG4gICAgdGhpcy5Db21wb25lbnREYXRhQXJyYXkuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgIGlmIChldmVudFJlZi5yZWYudGFyZ2V0ID09IGVsZW1lbnQubGV2ZWwpIHtcbiAgICAgICAgdGhpcy5hcnJheW9mc2FtZUxldmVsID0gdGhpcy5hcnJheW9mc2FtZUxldmVsLmNvbmNhdChlbGVtZW50KTtcblxuICAgICAgfVxuXG4gICAgfSk7XG4gIH1cblxuICAvL01ldGhvZCBDcmVhdGVzIHN0eWxlIGlmIHR3byBzYW1lIHRhcmdldHMgZm91bmQuXG4gIGdldENvbnRleHRNZW51U3R5bGUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICdjdXJzb3InOiAnZGVmYXVsdCcsXG4gICAgICAncG9zaXRpb24nOiAnZml4ZWQnLFxuICAgICAgJ2Rpc3BsYXknOiB0aGlzLmNvbnRleHRtZW51RmxhZyA/ICdibG9jaycgOiAnbm9uZScsXG4gICAgICAnbGVmdCc6IHRoaXMubW91c2VMb2NhdGlvbi5sZWZ0ICsgJ3B4JyxcbiAgICAgICd0b3AnOiB0aGlzLm1vdXNlTG9jYXRpb24udG9wICsgJ3B4JyxcbiAgICAgICdib3gtc2hhZG93JzogJzFweCAxcHggMnB4ICMwMDAwMDAnLFxuICAgICAgJ3dpZHRoJzogJzE1JScsXG4gICAgfTtcbiAgfVxuXG5cblxuICBnZXRMaXN0UG9zaXRpb24oZWxlbWVudFJlZjogYW55KTogYm9vbGVhbiB7XG4gICAgY29uc3QgaGVpZ2h0ID0gMjQwO1xuICAgIGlmICgod2luZG93LnNjcmVlbi5oZWlnaHQgLSBlbGVtZW50UmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSkgPCBoZWlnaHQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgb25Db250ZXh0Tm9kZUNsaWNrKGV2ZW50OiBhbnkpIHtcbiAgICB0aGlzLmNvbXBvbmVudGNvdW50ZXIgPSAwO1xuICAgIHRoaXMuY29udGV4dG1lbnVGbGFnID0gZmFsc2U7XG4gICAgdGhpcy5ldmVudERhdGEucmVmLmRyaWxsYWJsZUZsYWcgPSBmYWxzZTtcbiAgICB0aGlzLmRpc2FibGVGbGFnID0gdHJ1ZTtcbiAgICBldmVudC5kcmlsbGFibGVGbGFnID0gdHJ1ZTtcbiAgICBldmVudC5mZXRjaERhdGEodGhpcy5ldmVudERhdGEubm9kZSk7XG4gICAgdGhpcy5jb21wb25lbnRjb3VudGVyID0gZXZlbnQubGV2ZWw7XG5cbiAgICBpZiAodGhpcy5jb21wb25lbnRjb3VudGVyID09IHRoaXMuZXZlbnREYXRhLnJlZi5sZXZlbCkge1xuICAgICAgdGhpcy5ldmVudERhdGEucmVmLmRyaWxsYWJsZUZsYWcgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIG9uQ2xvc2VDbGljaygpIHtcbiAgICB0aGlzLmNvbnRleHRtZW51RmxhZyA9IGZhbHNlO1xuICB9XG5cbn1cbiJdfQ==