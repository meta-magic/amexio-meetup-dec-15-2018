/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, ViewChild, ElementRef, ChangeDetectorRef, } from "@angular/core";
import { AmexioD3BaseChartComponent } from "../base/base.component";
import { CommanDataService } from '../services/comman.data.service';
import { DeviceQueryService } from '../services/device.query.service';
import * as d3 from 'd3';
var AmexioD3BarChartComponent = /** @class */ (function (_super) {
    tslib_1.__extends(AmexioD3BarChartComponent, _super);
    function AmexioD3BarChartComponent(myservice, cdf, device) {
        var _this = _super.call(this, 'bar') || this;
        _this.myservice = myservice;
        _this.cdf = cdf;
        _this.device = device;
        _this.svgheight = 300;
        _this.horizontal = false;
        _this.labelcolor = "black";
        _this.labelflag = false;
        _this.level = 0;
        _this.drillabledatakey = [];
        _this.hScale = true;
        _this.resizeflag = false;
        _this.drillableFlag = true;
        _this.colorflag = false;
        _this.keyArray = [];
        _this.transformeddata = [];
        _this.legendArray = [];
        return _this;
    }
    /**
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.level <= 1) {
            /** @type {?} */
            var resp_1;
            if (this.httpmethod && this.httpurl) {
                this.myservice.fetchUrlData(this.httpurl, this.httpmethod).subscribe(function (response) {
                    resp_1 = response;
                }, function (error) {
                }, function () {
                    setTimeout(function () {
                        _this.data = _this.getResponseData(resp_1);
                        _this.drawChart();
                    }, 0);
                });
            }
            else if (this.data) {
                setTimeout(function () {
                    _this.data = _this.getResponseData(_this.data);
                    _this.transformData(_this.data);
                    _this.initializeData();
                    _this.plotD3Chart();
                }, 0);
            }
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.fetchData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var requestJson;
        /** @type {?} */
        var key = this.drillabledatakey;
        /** @type {?} */
        var resp;
        if (this.drillabledatakey.length) {
            /** @type {?} */
            var drillabledata = this.getMultipleDrillbleKeyData(data, key);
            requestJson = drillabledata;
        }
        else {
            requestJson = data;
        }
        if (this.httpmethod && this.httpurl) {
            this.myservice.postfetchData(this.httpurl, this.httpmethod, requestJson).subscribe(function (response) {
                resp = response;
            }, function (error) {
            }, function () {
                setTimeout(function () {
                    _this.data = _this.getResponseData(resp);
                    _this.drawChart();
                }, 0);
            });
        }
    };
    /**
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.drawChart = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout(function () {
            _this.initializeData();
            _this.plotD3Chart();
        }, 0);
    };
    /**
     * @param {?} httpResponse
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.getResponseData = /**
     * @param {?} httpResponse
     * @return {?}
     */
    function (httpResponse) {
        /** @type {?} */
        var responsedata = httpResponse;
        if (this.datareader != null) {
            /** @type {?} */
            var dr = this.datareader.split('.');
            try {
                for (var dr_1 = tslib_1.__values(dr), dr_1_1 = dr_1.next(); !dr_1_1.done; dr_1_1 = dr_1.next()) {
                    var ir = dr_1_1.value;
                    responsedata = responsedata[ir];
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (dr_1_1 && !dr_1_1.done && (_a = dr_1.return)) _a.call(dr_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        else {
            responsedata = httpResponse;
        }
        return responsedata;
        var e_1, _a;
    };
    /**
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.plotD3Chart = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.formLegendData();
        if (this.resizeflag == false) {
            if (this.chartId) {
                this.svgwidth = this.chartId.nativeElement.offsetWidth;
            }
            else {
                this.svgwidth = this.svgwidth;
            }
        }
        /** @type {?} */
        var tooltip = this.toolTip(d3);
        this.svg = d3.select("#" + this.componentId);
        /** @type {?} */
        var margin = { top: 20, right: 60, bottom: 30, left: 60 };
        /** @type {?} */
        var width = this.svgwidth - margin.left - margin.right;
        /** @type {?} */
        var height = this.svgheight - margin.top - margin.bottom;
        //const height = +svg.attr("height") - margin.top - margin.bottom;
        /** @type {?} */
        var x;
        /** @type {?} */
        var y;
        /** @type {?} */
        var g = this.svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        if (this.horizontal == false) {
            x = d3.scaleBand()
                .rangeRound([0, width])
                .padding(0.1);
            y = d3.scaleLinear()
                .rangeRound([height, 0]);
            //setting content for x and y axis
            x.domain(this.data.map(function (d) {
                return d[Object.keys(d)[0]];
                //    return d.label
            }));
            y.domain([0, d3.max(this.data, function (d) {
                    return d[Object.keys(d)[1]];
                    //return d.value;
                })]);
            // add x axis to svg
            if (this.device.IsDesktop() == true) {
                g.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(x));
            }
            else {
                g.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(x)).
                    selectAll("text")
                    .attr("y", 0)
                    .attr("x", 9)
                    .attr("dy", ".35em")
                    .attr("transform", "rotate(60)")
                    .style("text-anchor", "start");
            }
            //add y axis to svg
            g.append("g")
                .call(d3.axisLeft(y)
                .ticks(10));
            this.plotLine(g, x, y, height, width);
            //add bar chart
            g.selectAll(".bar")
                .data(this.data)
                .enter()
                .append("rect")
                .attr("class", "bar")
                .attr("x", function (d) {
                return x(d[Object.keys(d)[0]]);
                // return x(d.label); 
            })
                .attr("y", function (d) {
                return y(d[Object.keys(d)[1]]);
                // return y(d.value); 
            })
                .attr("cursor", "pointer")
                .attr("width", x.bandwidth())
                .attr("height", function (d) { return height - y(d[Object.keys(d)[1]]); })
                .style("fill", function (d) {
                // return "blue";
                return d.color;
            })
                .on("mouseover", function (d) {
                return tooltip.style("visibility", "visible");
            })
                .on("mousemove", function (d) {
                return tooltip.html(_this.formTooltipData(d)
                //  this.toolTipForBar(d)
                // this.toolTipContent(d)
                )
                    .style("top", (d3.event.pageY - 10) + "px")
                    .style("left", (d3.event.pageX + 10) + "px");
            })
                .on("mouseout", function (d) {
                return tooltip.style("visibility", "hidden");
            })
                .on("click", function (d) {
                _this.barChartClick(d);
                _this.fordrillableClick(_this, d, event);
                return tooltip.style("visibility", "hidden");
                //this.chartClick(d);
            });
            if (this.labelflag) {
                /** @type {?} */
                var yTextPadding = 40;
                this.svg.selectAll(".label")
                    .data(this.data)
                    .enter()
                    .append("text")
                    .style("font-weight", "bold")
                    .style("font-size", "1vw")
                    .attr("text-anchor", "middle")
                    .attr("fill", function (d) {
                    if (_this.labelcolor.length > 0) {
                        return _this.labelcolor;
                    }
                    else {
                        return "black";
                    }
                })
                    .attr("x", function (d, i) {
                    return x(d[Object.keys(d)[0]]) + margin.left + x.bandwidth() / 2;
                })
                    .attr("y", function (d, i) {
                    return y(d[Object.keys(d)[1]]) + yTextPadding;
                })
                    .text(function (d) {
                    return d[Object.keys(d)[1]];
                });
            } //if ends fr 
        }
        else if (this.horizontal == true) {
            x = d3.scaleLinear()
                .rangeRound([0, width]);
            y = d3.scaleBand()
                .rangeRound([height, 0]).padding(0.1);
            //setting content for x and y axis
            x.domain([0, d3.max(this.data, function (d) {
                    return parseInt(d[Object.keys(d)[1]]
                    // d.value
                    );
                })]);
            // d[Object.keys(d)[1]]
            y.domain(this.data.map(function (d) {
                return d[Object.keys(d)[0]];
                //return d.label;
            }));
            // add x axis to svg
            g.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x).ticks(10));
            //add y axis to svg
            g.append("g")
                .call(d3.axisLeft(y));
            this.plotLine(g, x, y, height, width);
            //add bar chart
            g.selectAll(".bar")
                .data(this.data)
                .enter()
                .append("rect")
                .attr("class", "bar")
                .attr("x", 0)
                .attr("y", function (d) {
                return y(d[Object.keys(d)[0]]
                // d.label
                );
            })
                .attr("cursor", "pointer")
                .attr("width", function (d) {
                return x(d[Object.keys(d)[1]]
                // d.value
                );
            })
                .attr("height", y.bandwidth())
                .style("fill", function (d) { return d.color; })
                .on("mouseover", function (d) {
                return tooltip.style("visibility", "visible");
            })
                .on("mousemove", function (d) {
                return tooltip.html(_this.formTooltipData(d)
                // this.formLegendData(d)
                // this.toolTipContent(d)
                )
                    .style("top", (d3.event.pageY - 10) + "px")
                    .style("left", (d3.event.pageX + 10) + "px");
            })
                .on("mouseout", function (d) {
                return tooltip.style("visibility", "hidden");
            })
                .on("click", function (d) {
                _this.barChartClick(d);
                _this.fordrillableClick(_this, d, event);
                return tooltip.style("visibility", "hidden");
                //this.chartClick(d);
            });
            if (this.labelflag) {
                /** @type {?} */
                var yTextPadding_1 = 40;
                this.svg.selectAll(".label")
                    .data(this.data)
                    .enter()
                    .append("text")
                    .style("font-weight", "bold")
                    .attr("text-anchor", "middle")
                    .attr("vertical-align", "middle")
                    .attr("margin-top", margin.top)
                    .attr("fill", function (d) {
                    if (_this.labelcolor.length > 0) {
                        return _this.labelcolor;
                    }
                    else {
                        return "black";
                    }
                })
                    .attr("x", function (d, i) {
                    return x(d[Object.keys(d)[1]]) + yTextPadding_1;
                })
                    .attr("y", function (d, i) {
                    return y(d[Object.keys(d)[0]])
                        + margin.top + y.bandwidth() / 2;
                })
                    .text(function (d) {
                    return d[Object.keys(d)[1]];
                });
            }
        } //else ends(horizontal bar logic ends)
    };
    /**
     * @param {?} g
     * @param {?} x
     * @param {?} y
     * @param {?} height
     * @param {?} width
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.plotLine = /**
     * @param {?} g
     * @param {?} x
     * @param {?} y
     * @param {?} height
     * @param {?} width
     * @return {?}
     */
    function (g, x, y, height, width) {
        if (this.hScale) {
            g.append('g')
                .attr("color", "lightgrey")
                .call(d3.axisLeft(y)
                .tickSize(-width).tickFormat(''));
        }
    };
    /**
     * @param {?} tooltipData
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.formTooltipData = /**
     * @param {?} tooltipData
     * @return {?}
     */
    function (tooltipData) {
        /** @type {?} */
        var object = {};
        try {
            for (var _a = tslib_1.__values(Object.entries(tooltipData)), _b = _a.next(); !_b.done; _b = _a.next()) {
                var _c = tslib_1.__read(_b.value, 2), key = _c[0], value = _c[1];
                if (key != 'color') {
                    object[key] = value;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_d = _a.return)) _d.call(_a);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return this.toolTipForBar(object);
        var e_2, _d;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.transformData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        this.keyArray = data[0];
        data.forEach(function (element, index) {
            if (index > 0) {
                /** @type {?} */
                var DummyObject_1 = {};
                element.forEach(function (individualvalue, keyindex) {
                    DummyObject_1[_this.keyArray[keyindex]] = individualvalue;
                }); //inner for loop ends
                _this.transformeddata.push(DummyObject_1);
            } //if ends
        }); //outer for loop ends
        this.data = this.transformeddata;
    };
    /**
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.formLegendData = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.legendArray = [];
        this.data.forEach(function (element) {
            /** @type {?} */
            var legendobject = {};
            legendobject['label'] = element[Object.keys(element)[0]];
            legendobject['value'] = element[Object.keys(element)[1]];
            legendobject['color'] = element.color;
            _this.legendArray.push(legendobject);
        });
    };
    /**
     * @param {?} legendevent
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.onBarLegendClick = /**
     * @param {?} legendevent
     * @return {?}
     */
    function (legendevent) {
        /** @type {?} */
        var obj = {};
        //  obj['label'] = legendevent.label;
        //  obj['value'] = legendevent.value;
        obj[this.keyArray[0]] = legendevent.label;
        obj[this.keyArray[1]] = legendevent.value;
        //obj[legendevent.label] = legendevent.value;
        //delete event.color;
        this.legendClick(obj);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.barChartClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var object = {};
        try {
            for (var _a = tslib_1.__values(Object.entries(event)), _b = _a.next(); !_b.done; _b = _a.next()) {
                var _c = tslib_1.__read(_b.value, 2), key = _c[0], value = _c[1];
                if (key != 'color') {
                    object[key] = value;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_d = _a.return)) _d.call(_a);
            }
            finally { if (e_3) throw e_3.error; }
        }
        this.chartClick(object);
        var e_3, _d;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AmexioD3BarChartComponent.prototype.resize = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.svg.selectAll("*").remove();
        this.resizeflag = true;
        this.svgwidth = this.divid.nativeElement.offsetWidth;
        this.cdf.detectChanges();
        this.plotD3Chart();
    };
    AmexioD3BarChartComponent.decorators = [
        { type: Component, args: [{
                    selector: 'amexio-d3-chart-bar',
                    template: "<div *ngIf=\"drillableFlag\"  #divid (window:resize)=\"resize($event)\" >\n<table style=\"width: 100%;\" position=\" relative\" #chartId >\n    <tr>\n        <td style=\"font-size: 18px; font-weight: bold; \"> {{title}} </td>\n    </tr>\n    <tr>\n        <td>\n            <svg [attr.height]=\"svgheight\" [attr.width]=\"svgwidth\" [attr.id]=\"componentId\" \n          >\n            </svg>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"display: block; padding: 5px;\">\n            <amexio-d3-legend *ngIf=\"legend\" [horizontal]=\"true\" (onClick)=\"onBarLegendClick($event)\" [data]=\"legendArray\" style=\"height:100%;\">\n            </amexio-d3-legend>\n        </td>\n    </tr>\n</table>\n</div>"
                },] },
    ];
    AmexioD3BarChartComponent.ctorParameters = function () { return [
        { type: CommanDataService },
        { type: ChangeDetectorRef },
        { type: DeviceQueryService }
    ]; };
    AmexioD3BarChartComponent.propDecorators = {
        svgwidth: [{ type: Input, args: ['width',] }],
        svgheight: [{ type: Input, args: ['height',] }],
        horizontal: [{ type: Input }],
        labelcolor: [{ type: Input, args: ['label-color',] }],
        labelflag: [{ type: Input, args: ['label',] }],
        chartId: [{ type: ViewChild, args: ['chartId',] }],
        divid: [{ type: ViewChild, args: ['divid',] }],
        drillid: [{ type: ViewChild, args: ['drillid',] }],
        datareader: [{ type: Input, args: ['data-reader',] }],
        level: [{ type: Input, args: ['level',] }],
        target: [{ type: Input, args: ['target',] }],
        drillabledatakey: [{ type: Input, args: ['drillable-data',] }],
        hScale: [{ type: Input, args: ['horizontal-scale',] }]
    };
    return AmexioD3BarChartComponent;
}(AmexioD3BaseChartComponent));
export { AmexioD3BarChartComponent };
if (false) {
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.svgwidth;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.svgheight;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.horizontal;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.labelcolor;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.labelflag;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.chartId;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.divid;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.drillid;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.datareader;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.level;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.target;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.drillabledatakey;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.hScale;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.resizeflag;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.checkmob;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.resizeg;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.drillableFlag;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.data;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.xaxis;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.yaxis;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.svg;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.colorflag;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.keyArray;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.transformeddata;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.object;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.legendArray;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.myservice;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.cdf;
    /** @type {?} */
    AmexioD3BarChartComponent.prototype.device;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FtZXhpby1jaGFydC1kMy8iLCJzb3VyY2VzIjpbImxpYi9iYXIvYmFyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsaUJBQWlCLEdBQUcsTUFBTSxlQUFlLENBQUM7QUFDNUYsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFFcEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDcEUsT0FBTSxFQUFDLGtCQUFrQixFQUFDLE1BQU0sa0NBQWtDLENBQUM7QUFFbkUsT0FBTyxLQUFLLEVBQUUsTUFBTSxJQUFJLENBQUM7QUFHekI7SUF1QitDLHFEQUEwQjtJQTJCckUsbUNBQW9CLFNBQTRCLEVBQVUsR0FBc0IsRUFBUyxNQUF5QjtRQUFsSCxZQUVJLGtCQUFNLEtBQUssQ0FBQyxTQUdmO1FBTG1CLGVBQVMsR0FBVCxTQUFTLENBQW1CO1FBQVUsU0FBRyxHQUFILEdBQUcsQ0FBbUI7UUFBUyxZQUFNLEdBQU4sTUFBTSxDQUFtQjtRQXpCakcsZUFBUyxHQUFXLEdBQUcsQ0FBQztRQUNoQyxnQkFBVSxHQUFZLEtBQUssQ0FBQztRQUNmLGdCQUFVLEdBQVcsT0FBTyxDQUFDO1FBQ25DLGVBQVMsR0FBWSxLQUFLLENBQUM7UUFLM0IsV0FBSyxHQUFXLENBQUMsQ0FBQztRQUVULHNCQUFnQixHQUFVLEVBQUUsQ0FBQztRQUMzQixZQUFNLEdBQVksSUFBSSxDQUFDO1FBQ2xELGdCQUFVLEdBQVksS0FBSyxDQUFDO1FBRzVCLG1CQUFhLEdBQVksSUFBSSxDQUFDO1FBSzlCLGVBQVMsR0FBWSxLQUFLLENBQUM7UUFDM0IsY0FBUSxHQUFVLEVBQUUsQ0FBQztRQUNyQixxQkFBZSxHQUFVLEVBQUUsQ0FBQztRQUU1QixpQkFBVyxH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Qjs7SUFDM0IsNkNBQXFCOztJQUNyQixvREFBNEI7O0lBQzVCLDJDQUFZOztJQUNaLGdEQUF3Qjs7SUFDWiw4Q0FBb0M7O0lBQUUsd0NBQThCOztJQUFDLDJDQUFpQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgQ2hhbmdlRGV0ZWN0b3JSZWYsIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IEFtZXhpb0QzQmFzZUNoYXJ0Q29tcG9uZW50IH0gZnJvbSBcIi4uL2Jhc2UvYmFzZS5jb21wb25lbnRcIjtcbmltcG9ydCB7IFBsb3RDYXJ0IH0gZnJvbSBcIi4uL2Jhc2UvY2hhcnQuY29tcG9uZW50XCI7XG5pbXBvcnQgeyBDb21tYW5EYXRhU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2NvbW1hbi5kYXRhLnNlcnZpY2UnO1xuaW1wb3J0e0RldmljZVF1ZXJ5U2VydmljZX0gZnJvbSAnLi4vc2VydmljZXMvZGV2aWNlLnF1ZXJ5LnNlcnZpY2UnO1xuXG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5cblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdhbWV4aW8tZDMtY2hhcnQtYmFyJyxcbiAgICB0ZW1wbGF0ZTogYDxkaXYgKm5nSWY9XCJkcmlsbGFibGVGbGFnXCIgICNkaXZpZCAod2luZG93OnJlc2l6ZSk9XCJyZXNpemUoJGV2ZW50KVwiID5cbjx0YWJsZSBzdHlsZT1cIndpZHRoOiAxMDAlO1wiIHBvc2l0aW9uPVwiIHJlbGF0aXZlXCIgI2NoYXJ0SWQgPlxuICAgIDx0cj5cbiAgICAgICAgPHRkIHN0eWxlPVwiZm9udC1zaXplOiAxOHB4OyBmb250LXdlaWdodDogYm9sZDsgXCI+IHt7dGl0bGV9fSA8L3RkPlxuICAgIDwvdHI+XG4gICAgPHRyPlxuICAgICAgICA8dGQ+XG4gICAgICAgICAgICA8c3ZnIFthdHRyLmhlaWdodF09XCJzdmdoZWlnaHRcIiBbYXR0ci53aWR0aF09XCJzdmd3aWR0aFwiIFthdHRyLmlkXT1cImNvbXBvbmVudElkXCIgXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgIDwvdGQ+XG4gICAgPC90cj5cbiAgICA8dHI+XG4gICAgICAgIDx0ZCBzdHlsZT1cImRpc3BsYXk6IGJsb2NrOyBwYWRkaW5nOiA1cHg7XCI+XG4gICAgICAgICAgICA8YW1leGlvLWQzLWxlZ2VuZCAqbmdJZj1cImxlZ2VuZFwiIFtob3Jpem9udGFsXT1cInRydWVcIiAob25DbGljayk9XCJvbkJhckxlZ2VuZENsaWNrKCRldmVudClcIiBbZGF0YV09XCJsZWdlbmRBcnJheVwiIHN0eWxlPVwiaGVpZ2h0OjEwMCU7XCI+XG4gICAgICAgICAgICA8L2FtZXhpby1kMy1sZWdlbmQ+XG4gICAgICAgIDwvdGQ+XG4gICAgPC90cj5cbjwvdGFibGU+XG48L2Rpdj5gXG59KVxuZXhwb3J0IGNsYXNzIEFtZXhpb0QzQmFyQ2hhcnRDb21wb25lbnQgZXh0ZW5kcyBBbWV4aW9EM0Jhc2VDaGFydENvbXBvbmVudCBpbXBsZW1lbnRzIFBsb3RDYXJ0IHtcbiAgICBASW5wdXQoJ3dpZHRoJykgc3Znd2lkdGg6IG51bWJlcjtcbiAgICBASW5wdXQoJ2hlaWdodCcpIHN2Z2hlaWdodDogbnVtYmVyID0gMzAwO1xuICAgIEBJbnB1dCgpIGhvcml6b250YWw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBASW5wdXQoJ2xhYmVsLWNvbG9yJykgbGFiZWxjb2xvcjogc3RyaW5nID0gXCJibGFja1wiO1xuICAgIEBJbnB1dCgnbGFiZWwnKSBsYWJlbGZsYWc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBAVmlld0NoaWxkKCdjaGFydElkJykgY2hhcnRJZDogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdkaXZpZCcpICBkaXZpZDpFbGVtZW50UmVmO1xuICAgIEBWaWV3Q2hpbGQoJ2RyaWxsaWQnKSBkcmlsbGlkOiBhbnk7XG4gICAgQElucHV0KCdkYXRhLXJlYWRlcicpIGRhdGFyZWFkZXI6IHN0cmluZztcbiAgICBASW5wdXQoJ2xldmVsJykgbGV2ZWw6IG51bWJlciA9IDA7XG4gICAgQElucHV0KCd0YXJnZXQnKSB0YXJnZXQ6IG51bWJlcjtcbiAgICBASW5wdXQoJ2RyaWxsYWJsZS1kYXRhJykgZHJpbGxhYmxlZGF0YWtleTogYW55W10gPSBbXTtcbiAgICBASW5wdXQoJ2hvcml6b250YWwtc2NhbGUnKSBoU2NhbGU6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHJlc2l6ZWZsYWc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBjaGVja21vYjogYm9vbGVhbjtcbiAgICByZXNpemVnOmFueTtcbiAgICBkcmlsbGFibGVGbGFnOiBib29sZWFuID0gdHJ1ZTtcbiAgICBkYXRhOiBhbnk7XG4gICAgeGF4aXM6YW55O1xuICAgIHlheGlzOmFueTtcbiAgICBzdmc6YW55O1xuICAgIGNvbG9yZmxhZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGtleUFycmF5OiBhbnlbXSA9IFtdO1xuICAgIHRyYW5zZm9ybWVkZGF0YTogYW55W10gPSBbXTtcbiAgICBvYmplY3Q6IGFueTtcbiAgICBsZWdlbmRBcnJheTogYW55W10gPSBbXTtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIG15c2VydmljZTogQ29tbWFuRGF0YVNlcnZpY2UsIHByaXZhdGUgY2RmOiBDaGFuZ2VEZXRlY3RvclJlZixwcml2YXRlIGRldmljZTpEZXZpY2VRdWVyeVNlcnZpY2UpIHtcblxuICAgICAgICBzdXBlcignYmFyJyk7XG4gICAgICAgXG5cbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICBcblxuICAgICAgICBpZiAodGhpcy5sZXZlbCA8PSAxKSB7XG4gICAgICAgICAgICBsZXQgcmVzcDogYW55O1xuICAgICAgICAgICAgaWYgKHRoaXMuaHR0cG1ldGhvZCAmJiB0aGlzLmh0dHB1cmwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm15c2VydmljZS5mZXRjaFVybERhdGEodGhpcy5odHRwdXJsLCB0aGlzLmh0dHBtZXRob2QpLnN1YnNjcmliZSgocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzcCA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLmdldFJlc3BvbnNlRGF0YShyZXNwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhd0NoYXJ0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhKSB7XG5cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5nZXRSZXNwb25zZURhdGEodGhpcy5kYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybURhdGEodGhpcy5kYXRhKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGxvdEQzQ2hhcnQoKTtcblxuICAgICAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hEYXRhKGRhdGE6IGFueSkge1xuXG4gICAgICAgIGxldCByZXF1ZXN0SnNvbjtcbiAgICAgICAgbGV0IGtleSA9IHRoaXMuZHJpbGxhYmxlZGF0YWtleTtcbiAgICAgICAgbGV0IHJlc3A6IGFueTtcbiAgICAgICAgaWYgKHRoaXMuZHJpbGxhYmxlZGF0YWtleS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBkcmlsbGFibGVkYXRhID0gdGhpcy5nZXRNdWx0aXBsZURyaWxsYmxlS2V5RGF0YShkYXRhLCBrZXkpO1xuICAgICAgICAgICAgcmVxdWVzdEpzb24gPSBkcmlsbGFibGVkYXRhO1xuXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXF1ZXN0SnNvbiA9IGRhdGE7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmh0dHBtZXRob2QgJiYgdGhpcy5odHRwdXJsKSB7XG4gICAgICAgICAgICB0aGlzLm15c2VydmljZS5wb3N0ZmV0Y2hEYXRhKHRoaXMuaHR0cHVybCwgdGhpcy5odHRwbWV0aG9kLCByZXF1ZXN0SnNvbikuc3Vic2NyaWJlKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc3AgPSByZXNwb25zZTtcbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLmdldFJlc3BvbnNlRGF0YShyZXNwKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3Q2hhcnQoKTtcbiAgICAgICAgICAgICAgICB9LCAwKTtcblxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZHJhd0NoYXJ0KCkge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcblxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplRGF0YSgpO1xuICAgICAgICAgICAgdGhpcy5wbG90RDNDaGFydCgpO1xuICAgICAgICB9LCAwKTtcblxuICAgIH1cbiAgICBnZXRSZXNwb25zZURhdGEoaHR0cFJlc3BvbnNlOiBhbnkpIHtcbiAgICAgICAgbGV0IHJlc3BvbnNlZGF0YSA9IGh0dHBSZXNwb25zZTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YXJlYWRlciAhPSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBkciA9IHRoaXMuZGF0YXJlYWRlci5zcGxpdCgnLicpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBpciBvZiBkcikge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlZGF0YSA9IHJlc3BvbnNlZGF0YVtpcl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNwb25zZWRhdGEgPSBodHRwUmVzcG9uc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlZGF0YTtcbiAgICB9XG5cbiAgICBwbG90RDNDaGFydCgpOiBhbnkge1xuXG4gICAgICAgIHRoaXMuZm9ybUxlZ2VuZERhdGEoKTtcbiAgICAgICAgICAgaWYodGhpcy5yZXNpemVmbGFnPT1mYWxzZSl7XG4gICAgICAgICAgIGlmKHRoaXMuY2hhcnRJZCApe1xuXG4gICAgICAgICAgICAgdGhpcy5zdmd3aWR0aCA9IHRoaXMuY2hhcnRJZC5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgIFxuICAgICAgICAgIH0gZWxzZXtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN2Z3dpZHRoID0gdGhpcy5zdmd3aWR0aDtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgIFxuICAgICAgICBcbiAgICAgICAgY29uc3QgdG9vbHRpcCA9IHRoaXMudG9vbFRpcChkMyk7XG4gICAgICAgIHRoaXMuc3ZnID0gZDMuc2VsZWN0KFwiI1wiICsgdGhpcy5jb21wb25lbnRJZCkgO1xuICAgICAgICBjb25zdCBtYXJnaW4gPSB7IHRvcDogMjAsIHJpZ2h0OjYwLCBib3R0b206IDMwLCBsZWZ0OiA2MCB9O1xuICAgICAgXG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5zdmd3aWR0aCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0O1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLnN2Z2hlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xuICAgXG4gICAgICAgIC8vY29uc3QgaGVpZ2h0ID0gK3N2Zy5hdHRyKFwiaGVpZ2h0XCIpIC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b207XG4gICAgICBcbiAgICAgICAgbGV0IHgsIHk7XG4gICAgICAgIGNvbnN0IGcgPSB0aGlzLnN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsXCIgKyBtYXJnaW4udG9wICsgXCIpXCIpO1xuXG4gICAgICAgIGlmICh0aGlzLmhvcml6b250YWwgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHggPSBkMy5zY2FsZUJhbmQoKVxuICAgICAgICAgICAgICAgIC5yYW5nZVJvdW5kKFswLCB3aWR0aF0pXG4gICAgICAgICAgICAgICAgLnBhZGRpbmcoMC4xKTtcbiAgICAgICAgICAgIHkgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgICAgICAgICAgICAgLnJhbmdlUm91bmQoW2hlaWdodCwgMF0pO1xuXG4gICAgICAgICAgICAvL3NldHRpbmcgY29udGVudCBmb3IgeCBhbmQgeSBheGlzXG4gICAgICAgICAgICB4LmRvbWFpbih0aGlzLmRhdGEubWFwKChkKSA9PiB7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZFtPYmplY3Qua2V5cyhkKVswXV07XG4gICAgICAgICAgICAgICAgLy8gICAgcmV0dXJuIGQubGFiZWxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHkuZG9tYWluKFswLCBkMy5tYXgodGhpcy5kYXRhLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBkW09iamVjdC5rZXlzKGQpWzFdXTtcbiAgICAgICAgICAgICAgICAvL3JldHVybiBkLnZhbHVlO1xuICAgICAgICAgICAgfSldKTtcbiAgICAgICAgXG4gICAgICAgICAgXG4gICAgICAgICAgICAvLyBhZGQgeCBheGlzIHRvIHN2Z1xuICAgICAgICAgICAgaWYodGhpcy5kZXZpY2UuSXNEZXNrdG9wKCk9PXRydWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGcuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgLmNhbGwoZDMuYXhpc0JvdHRvbSh4KSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgIHtcbiAgICAgICAgICAgIGcuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgLmNhbGwoZDMuYXhpc0JvdHRvbSh4KSkuXG4gICAgICAgICAgICAgICAgICAgc2VsZWN0QWxsKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCAwKVxuICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCA5KVxuICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiZHlcIiwgXCIuMzVlbVwiKVxuICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwicm90YXRlKDYwKVwiKVxuICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwic3RhcnRcIik7XG4gICAgIFxuICAgICAgICAgIH1cbiAgICAgICAgIFxuICAgICAgICAgICAgLy9hZGQgeSBheGlzIHRvIHN2Z1xuICAgICAgICAgIGcuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgIC5jYWxsKGQzLmF4aXNMZWZ0KHkpXG4gICAgICAgICAgICAgICAgICAgIC50aWNrcygxMCkpXG4gICAgICAgIFxuICAgICAgICAgIHRoaXMucGxvdExpbmUoZywgeCwgeSwgaGVpZ2h0LCB3aWR0aCk7XG5cbiAgICAgICAgICAgLy9hZGQgYmFyIGNoYXJ0XG4gICAgICAgICAgICBnLnNlbGVjdEFsbChcIi5iYXJcIilcbiAgICAgICAgICAgICAgICAuZGF0YSh0aGlzLmRhdGEpXG4gICAgICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJiYXJcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgKGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgoZFtPYmplY3Qua2V5cyhkKVswXV0pO1xuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4geChkLmxhYmVsKTsgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgKGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHkoZFtPYmplY3Qua2V5cyhkKVsxXV0pO1xuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4geShkLnZhbHVlKTsgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuYXR0cihcImN1cnNvclwiLCBcInBvaW50ZXJcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHguYmFuZHdpZHRoKCkpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgKGQpID0+IHsgcmV0dXJuIGhlaWdodCAtIHkoZFtPYmplY3Qua2V5cyhkKVsxXV0pOyB9KVxuXG4gICAgICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4gXCJibHVlXCI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLmNvbG9yO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIChkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0b29sdGlwLnN0eWxlKFwidmlzaWJpbGl0eVwiLCBcInZpc2libGVcIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oXCJtb3VzZW1vdmVcIiwgKGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvb2x0aXAuaHRtbChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybVRvb2x0aXBEYXRhKGQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgdGhpcy50b29sVGlwRm9yQmFyKGQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnRvb2xUaXBDb250ZW50KGQpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInRvcFwiLCAoZDMuZXZlbnQucGFnZVkgLSAxMCkgKyBcInB4XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJsZWZ0XCIsIChkMy5ldmVudC5wYWdlWCArIDEwKSArIFwicHhcIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcC5zdHlsZShcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oXCJjbGlja1wiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhckNoYXJ0Q2xpY2soZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yZHJpbGxhYmxlQ2xpY2sodGhpcywgZCwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcC5zdHlsZShcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5jaGFydENsaWNrKGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYodGhpcy5sYWJlbGZsYWcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHlUZXh0UGFkZGluZyA9IDQwO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLnNlbGVjdEFsbChcIi5sYWJlbFwiKVxuICAgICAgICAgICAgICAgIC5kYXRhKHRoaXMuZGF0YSlcbiAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKFwiZm9udC13ZWlnaHRcIixcImJvbGRcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoXCJmb250LXNpemVcIixcIjF2d1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgKGQpPT57XG4gICAgICAgICAgICAgICAgICBpZih0aGlzLmxhYmVsY29sb3IubGVuZ3RoPjApe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sYWJlbGNvbG9yO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYmxhY2tcIjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCAoZCxpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4KGRbT2JqZWN0LmtleXMoZClbMF1dKSsgbWFyZ2luLmxlZnQgKyB4LmJhbmR3aWR0aCgpLzI7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgKGQsaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHkoZFtPYmplY3Qua2V5cyhkKVsxXV0pK3lUZXh0UGFkZGluZztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50ZXh0KChkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICByZXR1cm4gZFtPYmplY3Qua2V5cyhkKVsxXV07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfS8vaWYgZW5kcyBmciBcbiAgICAgICAgfVxuXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaG9yaXpvbnRhbCA9PSB0cnVlKSB7XG5cbiAgICAgICAgICAgIHggPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgICAgICAgICAgICAgLnJhbmdlUm91bmQoWzAsIHdpZHRoXSlcbiAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICB5ID0gZDMuc2NhbGVCYW5kKClcbiAgICAgICAgICAgICAgICAucmFuZ2VSb3VuZChbaGVpZ2h0LCAwXSkucGFkZGluZygwLjEpO1xuXG4gICAgICAgICAgICAvL3NldHRpbmcgY29udGVudCBmb3IgeCBhbmQgeSBheGlzXG4gICAgICAgICAgICB4LmRvbWFpbihbMCwgZDMubWF4KHRoaXMuZGF0YSxcbiAgICAgICAgICAgICAgICAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICBkW09iamVjdC5rZXlzKGQpWzFdXVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZC52YWx1ZVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pXSk7XG4gICAgICAgICAgICAvLyBkW09iamVjdC5rZXlzKGQpWzFdXVxuXG4gICAgICAgICAgICB5LmRvbWFpbih0aGlzLmRhdGEubWFwKChkKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRbT2JqZWN0LmtleXMoZClbMF1dXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gZC5sYWJlbDtcbiAgICAgICAgICAgIH0pKVxuXG4gICAgICAgICAgICAvLyBhZGQgeCBheGlzIHRvIHN2Z1xuICAgICAgICAgICAgZy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgIC5jYWxsKGQzLmF4aXNCb3R0b20oeCkudGlja3MoMTApKTtcblxuICAgICAgICAgICAgLy9hZGQgeSBheGlzIHRvIHN2Z1xuICAgICAgICAgICAgZy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgLmNhbGwoZDMuYXhpc0xlZnQoeSkpXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wbG90TGluZShnLCB4LCB5LCBoZWlnaHQsIHdpZHRoKTtcbiAgICAgICAgICAgIC8vYWRkIGJhciBjaGFydFxuICAgICAgICAgICAgZy5zZWxlY3RBbGwoXCIuYmFyXCIpXG4gICAgICAgICAgICAgICAgLmRhdGEodGhpcy5kYXRhKVxuICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYmFyXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIDApXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIChkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB5KFxuICAgICAgICAgICAgICAgICAgICAgICAgZFtPYmplY3Qua2V5cyhkKVswXV1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGQubGFiZWxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY3Vyc29yXCIsIFwicG9pbnRlclwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgKGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHgoXG4gICAgICAgICAgICAgICAgICAgICAgICBkW09iamVjdC5rZXlzKGQpWzFdXVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZC52YWx1ZVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB5LmJhbmR3aWR0aCgpKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgKGQpID0+IHsgcmV0dXJuIGQuY29sb3I7IH0pXG4gICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIChkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0b29sdGlwLnN0eWxlKFwidmlzaWJpbGl0eVwiLCBcInZpc2libGVcIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oXCJtb3VzZW1vdmVcIiwgKGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvb2x0aXAuaHRtbChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybVRvb2x0aXBEYXRhKGQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmZvcm1MZWdlbmREYXRhKGQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnRvb2xUaXBDb250ZW50KGQpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInRvcFwiLCAoZDMuZXZlbnQucGFnZVkgLSAxMCkgKyBcInB4XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJsZWZ0XCIsIChkMy5ldmVudC5wYWdlWCArIDEwKSArIFwicHhcIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcC5zdHlsZShcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAub24oXCJjbGlja1wiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhckNoYXJ0Q2xpY2soZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yZHJpbGxhYmxlQ2xpY2sodGhpcywgZCwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcC5zdHlsZShcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5jaGFydENsaWNrKGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgIGlmKHRoaXMubGFiZWxmbGFnKVxuICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGV0IHlUZXh0UGFkZGluZyA9IDQwO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ZnLnNlbGVjdEFsbChcIi5sYWJlbFwiKVxuICAgICAgICAgICAgICAgIC5kYXRhKHRoaXMuZGF0YSlcbiAgICAgICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKFwiZm9udC13ZWlnaHRcIixcImJvbGRcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcInZlcnRpY2FsLWFsaWduXCIsXCJtaWRkbGVcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmdpbi10b3BcIixtYXJnaW4udG9wKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCAoZCk9PntcbiAgICAgICAgICAgICAgICAgIGlmKHRoaXMubGFiZWxjb2xvci5sZW5ndGg+MCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxhYmVsY29sb3I7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJibGFja1wiO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIChkLGkpID0+IHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB4KGRbT2JqZWN0LmtleXMoZClbMV1dKSt5VGV4dFBhZGRpbmc7XG4gICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIChkLGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5KGRbT2JqZWN0LmtleXMoZClbMF1dKVxuICAgICAgICAgICAgICAgICAgICAgKyBtYXJnaW4udG9wICsgeS5iYW5kd2lkdGgoKS8yO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRleHQoIChkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICByZXR1cm4gZFtPYmplY3Qua2V5cyhkKVsxXV07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICBcblxuICAgICAgICB9Ly9lbHNlIGVuZHMoaG9yaXpvbnRhbCBiYXIgbG9naWMgZW5kcylcblxuICAgICBcblxuICAgIH1cblxuICAgIHBsb3RMaW5lKGcsIHgsIHksIGhlaWdodCwgd2lkdGgpIHtcblxuICAgICAgICBpZiAodGhpcy5oU2NhbGUpIHtcbiAgICAgICAgICAgIGcuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAuYXR0cihcImNvbG9yXCIsIFwibGlnaHRncmV5XCIpXG4gICAgICAgICAgICAgICAgLmNhbGwoZDMuYXhpc0xlZnQoeSlcbiAgICAgICAgICAgICAgICAgICAgLnRpY2tTaXplKC13aWR0aCkudGlja0Zvcm1hdCgnJykpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBmb3JtVG9vbHRpcERhdGEodG9vbHRpcERhdGE6IGFueSkge1xuICAgICAgICBsZXQgb2JqZWN0ID0ge307XG4gICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0b29sdGlwRGF0YSkpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT0gJ2NvbG9yJykge1xuICAgICAgICAgICAgICAgIG9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMudG9vbFRpcEZvckJhcihvYmplY3QpO1xuICAgIH1cblxuICAgIHRyYW5zZm9ybURhdGEoZGF0YTogYW55KSB7XG5cbiAgICAgICAgdGhpcy5rZXlBcnJheSA9IGRhdGFbMF07XG4gICAgICAgIGRhdGEuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICBsZXQgRHVtbXlPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmZvckVhY2goKGluZGl2aWR1YWx2YWx1ZSwga2V5aW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgRHVtbXlPYmplY3RbdGhpcy5rZXlBcnJheVtrZXlpbmRleF1dID0gaW5kaXZpZHVhbHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pOy8vaW5uZXIgZm9yIGxvb3AgZW5kc1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtZWRkYXRhLnB1c2goRHVtbXlPYmplY3QpO1xuICAgICAgICAgICAgfS8vaWYgZW5kc1xuICAgICAgICB9KTsvL291dGVyIGZvciBsb29wIGVuZHNcbiAgICAgICAgdGhpcy5kYXRhID0gdGhpcy50cmFuc2Zvcm1lZGRhdGE7XG4gICAgfVxuXG4gICAgZm9ybUxlZ2VuZERhdGEoKSB7XG4gICAgICAgIHRoaXMubGVnZW5kQXJyYXkgPSBbXTtcbiAgICAgICAgdGhpcy5kYXRhLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBsZXQgbGVnZW5kb2JqZWN0ID0ge307XG4gICAgICAgICAgICBsZWdlbmRvYmplY3RbJ2xhYmVsJ10gPSBlbGVtZW50W09iamVjdC5rZXlzKGVsZW1lbnQpWzBdXTtcbiAgICAgICAgICAgIGxlZ2VuZG9iamVjdFsndmFsdWUnXSA9IGVsZW1lbnRbT2JqZWN0LmtleXMoZWxlbWVudClbMV1dO1xuICAgICAgICAgICAgbGVnZW5kb2JqZWN0Wydjb2xvciddID0gZWxlbWVudC5jb2xvcjtcbiAgICAgICAgICAgIHRoaXMubGVnZW5kQXJyYXkucHVzaChsZWdlbmRvYmplY3QpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbkJhckxlZ2VuZENsaWNrKGxlZ2VuZGV2ZW50OiBhbnkpIHtcbiAgICAgICAgbGV0IG9iaiA9IHt9O1xuICAgICAgICAvLyAgb2JqWydsYWJlbCddID0gbGVnZW5kZXZlbnQubGFiZWw7XG4gICAgICAgIC8vICBvYmpbJ3ZhbHVlJ10gPSBsZWdlbmRldmVudC52YWx1ZTtcbiAgICAgICAgb2JqW3RoaXMua2V5QXJyYXlbMF1dID0gbGVnZW5kZXZlbnQubGFiZWw7XG4gICAgICAgIG9ialt0aGlzLmtleUFycmF5WzFdXSA9IGxlZ2VuZGV2ZW50LnZhbHVlO1xuICAgICAgICAvL29ialtsZWdlbmRldmVudC5sYWJlbF0gPSBsZWdlbmRldmVudC52YWx1ZTtcbiAgICAgICAgLy9kZWxldGUgZXZlbnQuY29sb3I7XG4gICAgICAgIHRoaXMubGVnZW5kQ2xpY2sob2JqKTtcbiAgICB9XG5cblxuICAgIGJhckNoYXJ0Q2xpY2soZXZlbnQ6IGFueSkge1xuICAgICAgICBsZXQgb2JqZWN0ID0ge307XG4gICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhldmVudCkpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT0gJ2NvbG9yJykge1xuICAgICAgICAgICAgICAgIG9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaGFydENsaWNrKG9iamVjdCk7XG4gICAgfVxuXG4gICAgcmVzaXplKGRhdGE6IGFueSkge1xuICAgICAgXG4gICAgICAgIHRoaXMuc3ZnLnNlbGVjdEFsbChcIipcIikucmVtb3ZlKCk7XG4gIFxuICAgICAgICB0aGlzLnJlc2l6ZWZsYWc9dHJ1ZTtcbiAgICAgICAgdGhpcy5zdmd3aWR0aCA9IHRoaXMuZGl2aWQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICAgXG4gICAgICAgIHRoaXMuY2RmLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgdGhpcy5wbG90RDNDaGFydCgpO1xuICAgXG4gICAgfVxuXG5cblxuICAgIFxuXG59Il19