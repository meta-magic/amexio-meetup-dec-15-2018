!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("d3"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define("amexio-chart-d3",["exports","@angular/core","@angular/common/http","d3","@angular/common","@angular/forms"],e):e(t["amexio-chart-d3"]={},t.ng.core,t.ng.common.http,null,t.ng.common,t.ng.forms)}(this,function(t,n,i,w,a,e){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)};function o(t,e){function a(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}function C(t){var e="function"==typeof Symbol&&t[Symbol.iterator],a=0;return e?e.call(t):{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}}}function D(t,e){var a="function"==typeof Symbol&&t[Symbol.iterator];if(!a)return t;var r,i,n=a.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(r=n.next()).done;)o.push(r.value)}catch(l){i={error:l}}finally{try{r&&!r.done&&(a=n["return"])&&a.call(n)}finally{if(i)throw i.error}}return o}var l=function(){function t(t){this.onLegendClick=new n.EventEmitter,this.onChartClick=new n.EventEmitter,this.onLineClick=new n.EventEmitter,this.drillableEvent=new n.EventEmitter,this.legend=!0,this.height="300",this.width="300",this.title="",this.possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcddefghijklmonpqrstuvwxyz",this.colorIndex=0,this.colors=[],this.charttype=t,this.predefinedcolors=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"],this.componentId=this.charttype+"-"+this.generateId()}return t.prototype.initializeData=function(){var e=this;this.data.forEach(function(t){t.color=e.getColor(t)})},t.prototype.getMultipleDrillbleKeyData=function(t,e){var a,r,i={};if(t){for(var n=0;n<e.length;n++){var o=e[n];try{for(var l=C(Object.entries(t)),s=l.next();!s.done;s=l.next()){var h=D(s.value,2),d=h[0],c=h[1];d==o&&(i[d]=c)}}catch(p){a={error:p}}finally{try{s&&!s.done&&(r=l["return"])&&r.call(l)}finally{if(a)throw a.error}}}return i}},t.prototype.generateId=function(){for(var t="",e=0;e<5;e++)t+=this.possible.charAt(Math.floor(Math.random()*this.possible.length));return t=t+"-"+(new Date).getTime()},t.prototype.getColor=function(t){if(t.color)return t.color;if(this.colors.length>this.colorIndex){var e=this.colors[this.colorIndex];return this.colorIndex++,e}if(0<this.colors.length&&this.colors.length<=this.colorIndex)return this.colorIndex=0,e=this.colors[this.colorIndex];e=this.predefinedcolors[this.colorIndex];return this.colorIndex++,e},t.prototype.legendClick=function(t){this.onLegendClick.emit(t)},t.prototype.chartClick=function(t){this.onChartClick.emit(t)},t.prototype.comboLineClick=function(t){this.onLineClick.emit(t)},t.prototype.fordrillableClick=function(t,e,a){this.drillableEvent.emit({ref:t,node:e,event:a})},t.prototype.toolTip=function(t){return t.select("body").append("div").attr("id","tooltipid").attr("class","amexiod3tooltip").style("position","absolute").style("z-index","10").style("visibility","hidden")},t.prototype.toolTipContent=function(t){var e="<table>";for(var a in t){if(t.hasOwnProperty(a))e+="<tr>",e+="<td>",e+=t[a],e+="</td>",e+="</tr>"}return e+="</table>"},t.prototype.toolTipWithLegendandAxis=function(t,e,a){var r="<div>";return r=(r=(r=r+"<b>"+e+"</b>, ")+t+"</b> ")+"<b>"+a+"</b> ",r+="</div>"},t.prototype.toolTipForBar=function(t){var e,a,r="<div>";try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];r=(r+="<div>")+"<span style =float:left ><b>"+l+" </b>"+s+"</br></span>",r+="</div>"}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return r},t.propDecorators={onLegendClick:[{type:n.Output}],onChartClick:[{type:n.Output}],onLineClick:[{type:n.Output}],drillableEvent:[{type:n.Output}],data:[{type:n.Input,args:["data"]}],httpurl:[{type:n.Input,args:["http-url"]}],httpmethod:[{type:n.Input,args:["http-method"]}],legend:[{type:n.Input,args:["legend"]}],colors:[{type:n.Input,args:["color"]}],height:[{type:n.Input,args:["height"]}],width:[{type:n.Input,args:["width"]}],title:[{type:n.Input,args:["title"]}]},t}(),s=function(){function t(t){this.http=t}return t.prototype.fetchUrlData=function(t,e){var a=(new i.HttpHeaders).append("Content-Type","application/json;charset=UTF-8");return"post"===e?this.http.post(t,{},{headers:a}):"get"===e?this.http.get(t,{headers:a}):void 0},t.prototype.postfetchData=function(t,e,a){var r=(new i.HttpHeaders).append("Content-Type","application/json;charset=UTF-8");return"post"===e?this.http.post(t,a,{headers:r}):"get"===e?this.http.get(t,{headers:r}):void 0},t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:i.HttpClient}]},t.ngInjectableDef=n.defineInjectable({factory:function(){return new t(n.inject(i.HttpClient))},token:t,providedIn:"root"}),t}(),h=function(r){function t(t,e){var a=r.call(this,"DONUTCHART")||this;return a.myservice=t,a.cdf=e,a.pie=!1,a.svgwidth=300,a.svgheight=300,a.labelcolor="black",a.labelflag=!1,a.level=0,a.drillableFlag=!0,a.keyArray=[],a.transformeddata=[],a.legendArray=[],a}return o(t,r),t.prototype.ngOnInit=function(){var e,t=this;this.level<=1?this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t},function(t){},function(){setTimeout(function(){t.data=t.getResponseData(e),t.drawChart(),t.data=t.getResponseData(e),t.initializeData(),t.plotD3Chart()},0)}):this.data&&setTimeout(function(){t.data=t.getResponseData(t.data),t.transformData(t.data),t.initializeData(),t.plotD3Chart()},0):this.fetchData(this.drillData)},t.prototype.fetchData=function(t){var e,a,r=this,i=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,i):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a=t,r.response=a},function(t){},function(){setTimeout(function(){r.data=r.getResponseData(a),r.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.drillableFlag=!0,t.initializeData(),t.plotD3Chart()},0)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.plotD3Chart=function(){var e=this;this.formLegendData();var t,a=0;t=this.svgwidth/2,a=this.svgwidth/4,this.pie&&(a=0);var r=this.toolTip(w),i=w.arc().outerRadius(t).innerRadius(a),n=w.pie().value(function(t){return t[Object.keys(t)[1]]});this.svg=w.select("#"+this.componentId).append("g").attr("transform","translate("+this.svgwidth/2+","+this.svgheight/2+")").selectAll("path").data(n(this.data)).enter();this.svg.append("path").attr("d",i).attr("fill",function(t,e){return t.data.color?t.data.color:"black"}).attr("cursor","pointer").on("mouseover",function(t){return r.style("visibility","visible")}).on("mousemove",function(t){return r.html(e.formTooltipData(t.data)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return r.style("visibility","hidden")}).on("click",function(t){return e.DonutChartClick(t.data),e.fordrillableClick(e,t.data,event),r.style("visibility","hidden")});if(this.labelflag)this.svg.append("text").transition().duration(200).attr("transform",function(t){return"translate("+i.centroid(t)+")"}).attr("text-anchor","middle").text(function(t){return t.data[Object.keys(t.data)[1]]}).style("fill",function(t){return 0<this.labelcolor.length?this.labelcolor:"black"}).style("font-size","12px")},t.prototype.formLegendData=function(){var a=this;this.legendArray=[],this.data.forEach(function(t){var e={};e.label=t[Object.keys(t)[0]],e.value=t[Object.keys(t)[1]],e.color=t.color,a.legendArray.push(e)})},t.prototype.onDonutLegendClick=function(t){var e={};e[this.keyArray[0]]=t.label,e[this.keyArray[1]]=t.value,this.legendClick(e)},t.prototype.transformData=function(t){var r=this;this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}}),this.data=this.transformeddata},t.prototype.formTooltipData=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&"textcolor"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return this.toolTipForBar(r)},t.prototype.DonutChartClick=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}this.chartClick(r)},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-donut",template:'<div *ngIf="drillableFlag" #chartId>\n\n\n    <div colspan="2" style="font-size: 18px; font-weight: bold; ">\n        {{title}}\n    </div>\n        <div style="display: flex;flex-direction: row">\n            <svg preserveAspectRatio="xMinYMin meet" viewBox="0 0 300 300" [attr.height]="height" [attr.width]="width" [attr.id]="componentId">\n            </svg>\n            <div>\n\n           <div style="display: block; padding: 1%;">\n                    <amexio-d3-legend *ngIf="legend" (onClick)="onDonutLegendClick($event)" [data]="legendArray" style="height:100%;"></amexio-d3-legend>\n          </div>\n   </div>\n    '}]}],t.ctorParameters=function(){return[{type:s},{type:n.ChangeDetectorRef}]},t.propDecorators={pie:[{type:n.Input,args:["pie"]}],svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}],divid:[{type:n.ViewChild,args:["divid"]}],drillid:[{type:n.ViewChild,args:["drillid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillData:[{type:n.Input}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}]},t}(l),d=function(){function t(){this.onLegendClick=new n.EventEmitter,this.onChartClick=new n.EventEmitter,this.drillableEvent=new n.EventEmitter,this.legend=!0,this.colors=[],this.width="300",this.height="300",this.title="",this.level=0,this.labelcolor="black",this.labelflag=!1,this.drillableFlag=!0}return t.prototype.ngOnInit=function(){},t.prototype.legendClick=function(t){this.onLegendClick.emit(t)},t.prototype.chartClick=function(t){this.onChartClick.emit(t)},t.prototype.fordrillableClick=function(t){this.drillableEvent.emit(t)},t.prototype.fetchData=function(t){this.drillData=t},t.prototype.drawChart=function(){this.donutref.drillableFlag=!0,this.donutref.drawChart()},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-pie",template:'<div   *ngIf="drillableFlag">\n<amexio-d3-chart-donut #id (onLegendClick)="legendClick($event)" \n                       (onChartClick)="chartClick($event)" \n                       (drillableEvent)=" fordrillableClick($event)"\n                        [height]="height"\n                        [width]="width"\n                        [title]="title"\n                        [data] = "data"\n                        [pie]  = "true"\n                        [color]="colors"\n                        [http-url]="httpurl"\n                        [http-method]="httpmethod"\n                        [data-reader]="datareader"\n                        [label]="labelflag"\n                        [label-color]="labelcolor"\n                        [level]="level"\n                        [target]="target"\n                        [drillable-data]="drillabledatakey"\n                        [drillData]="drillData">\n</amexio-d3-chart-donut>\n</div>\n'}]}],t.propDecorators={data:[{type:n.Input,args:["data"]}],onLegendClick:[{type:n.Output}],onChartClick:[{type:n.Output}],drillableEvent:[{type:n.Output}],donutref:[{type:n.ViewChild,args:["id"]}],legend:[{type:n.Input}],colors:[{type:n.Input,args:["color"]}],width:[{type:n.Input,args:["width"]}],height:[{type:n.Input,args:["height"]}],title:[{type:n.Input}],httpurl:[{type:n.Input,args:["http-url"]}],httpmethod:[{type:n.Input,args:["http-method"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}]},t}(),c=function(){function t(){this.horizontal=!1,this.onClick=new n.EventEmitter}return t.prototype.onLegendClick=function(t){this.onClick.emit(t)},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-legend",template:'<div style =" width: 100% ; padding-left: 20px; padding-top: 8px; ">\n<table *ngIf="!horizontal" style="height: 100%;">\n    <tr *ngFor = "let node of data" style="cursor: pointer;" (click)="onLegendClick(node)">\n        <td style="height: 10px; width: 23px; padding-left: 2px;"\n            [ngStyle]="{\'background-color\': node.color}"></td>\n        <td>{{node.label}}</td>\n    </tr>\n</table>\n</div>\n\n<table *ngIf="horizontal" style="height: 100%;">\n    <tr>\n        <td *ngFor = "let node of data" \n                    (click)="onLegendClick(node)" \n                    style="cursor: pointer;">\n            \n            <div style=" display: inline-block; display: inline-block; padding: 2px;">\n                    <div style=" width: 10px; display: inline-block; padding: 2px; " \n                    [ngStyle]="{\'background-color\': node.color}"></div>\n                {{node.label}}\n            </div>\n        </td>\n        \n    </tr>\n</table>'}]}],t.ctorParameters=function(){return[]},t.propDecorators={data:[{type:n.Input,args:["data"]}],horizontal:[{type:n.Input,args:["horizontal"]}],onClick:[{type:n.Output}]},t}(),p=function(){function t(t){this.platformId=t,this.rules={print:"print",screen:"screen",phone:"(max-width: 767px)",tablet:"(min-width: 768px) and (max-width: 1024px)",desktop:"(min-width: 1025px)",portrait:"(orientation: portrait)",landscape:"(orientation: landscape)",retina:"(-webkit-min-device-pixel-ratio: 2) and (min-resolution: 192dpi)"},this.Check=function(t){if(a.isPlatformBrowser(this.platformId)){if(!t)return;return window.matchMedia(t).matches}},this.IsTablet=function(){return a.isPlatformBrowser(this.platformId)?window.matchMedia(this.rules.tablet).matches:null},this.IsDesktop=function(){return a.isPlatformBrowser(this.platformId)?window.matchMedia(this.rules.desktop).matches:null},this.IsPortrait=function(){return a.isPlatformBrowser(this.platformId)?window.matchMedia(this.rules.portrait).matches:null},this.IsLandscape=function(){return a.isPlatformBrowser(this.platformId)?window.matchMedia(this.rules.landscape).matches:null},this.IsRetina=function(){return a.isPlatformBrowser(this.platformId)?window.matchMedia(this.rules.retina).matches:null},this.browserWindow=function(){return window}}return t.prototype.IsPhone=function(){return a.isPlatformBrowser(this.platformId)?window.matchMedia(this.rules.phone).matches:null},t.prototype.OnPhone=function(t){if("function"==typeof t&&a.isPlatformBrowser(this.platformId)){var e=window.matchMedia(this.rules.phone);this.mqlMethod(t,e)}},t.prototype.OnTablet=function(t){if("function"==typeof t&&a.isPlatformBrowser(this.platformId)){var e=window.matchMedia(this.rules.tablet);this.mqlMethod(t,e)}},t.prototype.OnDesktop=function(t){if("function"==typeof t&&a.isPlatformBrowser(this.platformId)){var e=window.matchMedia(this.rules.desktop);this.mqlMethod(t,e)}},t.prototype.OnPortrait=function(t){if("function"==typeof t&&a.isPlatformBrowser(this.platformId)){var e=window.matchMedia(this.rules.portrait);this.mqlMethod(t,e)}},t.prototype.OnLandscape=function(t){if("function"==typeof t&&a.isPlatformBrowser(this.platformId)){var e=window.matchMedia(this.rules.landscape);this.mqlMethod(t,e)}},t.prototype.mqlMethod=function(e,a){a.addListener(function(t){t.matches&&e(a)})},t.decorators=[{type:n.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},t}(),u=function(i){function t(t,e,a){var r=i.call(this,"bar")||this;return r.myservice=t,r.cdf=e,r.device=a,r.svgheight=300,r.horizontal=!1,r.labelcolor="black",r.labelflag=!1,r.level=0,r.drillabledatakey=[],r.hScale=!0,r.resizeflag=!1,r.drillableFlag=!0,r.colorflag=!1,r.keyArray=[],r.transformeddata=[],r.legendArray=[],r}return o(t,i),t.prototype.ngOnInit=function(){var e,t=this;this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t},function(t){},function(){setTimeout(function(){t.data=t.getResponseData(e),t.drawChart()},0)}):this.data&&setTimeout(function(){t.data=t.getResponseData(t.data),t.transformData(t.data),t.initializeData(),t.plotD3Chart()},0))},t.prototype.fetchData=function(t){var e,a,r=this,i=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,i):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a=t},function(t){},function(){setTimeout(function(){r.data=r.getResponseData(a),r.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.initializeData(),t.plotD3Chart()},0)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.plotD3Chart=function(){var e=this;this.formLegendData(),0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var a=this.toolTip(w);this.svg=w.select("#"+this.componentId);var r,i,n=20,t=60,o=30,l=60,s=this.svgwidth-l-t,h=this.svgheight-n-o,d=this.svg.append("g").attr("transform","translate("+l+","+n+")");if(0==this.horizontal){if(r=w.scaleBand().rangeRound([0,s]).padding(.1),i=w.scaleLinear().rangeRound([h,0]),r.domain(this.data.map(function(t){return t[Object.keys(t)[0]]})),i.domain([0,w.max(this.data,function(t){return t[Object.keys(t)[1]]})]),1==this.device.IsDesktop()?d.append("g").attr("transform","translate(0,"+h+")").call(w.axisBottom(r)):d.append("g").attr("transform","translate(0,"+h+")").call(w.axisBottom(r)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),d.append("g").call(w.axisLeft(i).ticks(10)),this.plotLine(d,r,i,h,s),d.selectAll(".bar").data(this.data).enter().append("rect").attr("class","bar").attr("x",function(t){return r(t[Object.keys(t)[0]])}).attr("y",function(t){return i(t[Object.keys(t)[1]])}).attr("cursor","pointer").attr("width",r.bandwidth()).attr("height",function(t){return h-i(t[Object.keys(t)[1]])}).style("fill",function(t){return t.color}).on("mouseover",function(t){return a.style("visibility","visible")}).on("mousemove",function(t){return a.html(e.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return a.style("visibility","hidden")}).on("click",function(t){return e.barChartClick(t),e.fordrillableClick(e,t,event),a.style("visibility","hidden")}),this.labelflag){this.svg.selectAll(".label").data(this.data).enter().append("text").style("font-weight","bold").style("font-size","1vw").attr("text-anchor","middle").attr("fill",function(t){return 0<e.labelcolor.length?e.labelcolor:"black"}).attr("x",function(t,e){return r(t[Object.keys(t)[0]])+l+r.bandwidth()/2}).attr("y",function(t,e){return i(t[Object.keys(t)[1]])+40}).text(function(t){return t[Object.keys(t)[1]]})}}else if(1==this.horizontal&&(r=w.scaleLinear().rangeRound([0,s]),i=w.scaleBand().rangeRound([h,0]).padding(.1),r.domain([0,w.max(this.data,function(t){return parseInt(t[Object.keys(t)[1]])})]),i.domain(this.data.map(function(t){return t[Object.keys(t)[0]]})),d.append("g").attr("transform","translate(0,"+h+")").call(w.axisBottom(r).ticks(10)),d.append("g").call(w.axisLeft(i)),this.plotLine(d,r,i,h,s),d.selectAll(".bar").data(this.data).enter().append("rect").attr("class","bar").attr("x",0).attr("y",function(t){return i(t[Object.keys(t)[0]])}).attr("cursor","pointer").attr("width",function(t){return r(t[Object.keys(t)[1]])}).attr("height",i.bandwidth()).style("fill",function(t){return t.color}).on("mouseover",function(t){return a.style("visibility","visible")}).on("mousemove",function(t){return a.html(e.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return a.style("visibility","hidden")}).on("click",function(t){return e.barChartClick(t),e.fordrillableClick(e,t,event),a.style("visibility","hidden")}),this.labelflag)){this.svg.selectAll(".label").data(this.data).enter().append("text").style("font-weight","bold").attr("text-anchor","middle").attr("vertical-align","middle").attr("margin-top",n).attr("fill",function(t){return 0<e.labelcolor.length?e.labelcolor:"black"}).attr("x",function(t,e){return r(t[Object.keys(t)[1]])+40}).attr("y",function(t,e){return i(t[Object.keys(t)[0]])+n+i.bandwidth()/2}).text(function(t){return t[Object.keys(t)[1]]})}},t.prototype.plotLine=function(t,e,a,r,i){this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.formTooltipData=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return this.toolTipForBar(r)},t.prototype.transformData=function(t){var r=this;this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}}),this.data=this.transformeddata},t.prototype.formLegendData=function(){var a=this;this.legendArray=[],this.data.forEach(function(t){var e={};e.label=t[Object.keys(t)[0]],e.value=t[Object.keys(t)[1]],e.color=t.color,a.legendArray.push(e)})},t.prototype.onBarLegendClick=function(t){var e={};e[this.keyArray[0]]=t.label,e[this.keyArray[1]]=t.value,this.legendClick(e)},t.prototype.barChartClick=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}this.chartClick(r)},t.prototype.resize=function(t){this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.cdf.detectChanges(),this.plotD3Chart()},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-bar",template:'<div *ngIf="drillableFlag"  #divid (window:resize)="resize($event)" >\n<table style="width: 100%;" position=" relative" #chartId >\n    <tr>\n        <td style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n    </tr>\n    <tr>\n        <td>\n            <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId" \n          >\n            </svg>\n        </td>\n    </tr>\n    <tr>\n        <td style="display: block; padding: 5px;">\n            <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="onBarLegendClick($event)" [data]="legendArray" style="height:100%;">\n            </amexio-d3-legend>\n        </td>\n    </tr>\n</table>\n</div>'}]}],t.ctorParameters=function(){return[{type:s},{type:n.ChangeDetectorRef},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],horizontal:[{type:n.Input}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],drillid:[{type:n.ViewChild,args:["drillid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}]},t}(l),f=function(a){function t(t){var e=a.call(this,"line")||this;return e.deviceQueryService=t,e.svgheight=300,e.hScale=!0,e.vScale=!1,e}return o(t,a),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.createXYAxisData()},enumerable:!0,configurable:!0}),t.prototype.createXYAxisData=function(){var a=this;this.xaxisdata=[],this.yaxisdata=[],this.multiseriesdata=[],this.legenddata=[],this.legends=[],this.xaxisname=this.data[0][0].label;for(var r=[],t=0;t<this._data[0].length;t++){var e=this._data[0][t];r[t]=[],this.legenddata.push({label:e.label,color:this.predefinedcolors[t+1]}),0<t&&this.legends.push({label:e.label,color:this.predefinedcolors[t]})}var i=0;this._data.forEach(function(t){if(0<i){var e=0;t.forEach(function(t){0===e?a.xaxisdata.push({label:t,value:t}):a.yaxisdata.push({label:t,value:t}),r[e].push(t),e++})}i++});for(t=0;t<r.length;t++){var n=r[t];if(0<t){for(var o=[],l=0;l<n.length;l++){var s=n[l];o.push({legend:this.legenddata[t].label,label:this.xaxisdata[l].value,value:s})}this.multiseriesdata.push(o),this.legends[t-1].data=o}}},t.prototype.initChart=function(){this.svg=w.select("#"+this.componentId);var t=40,e=20,a=30,r=40,i=+this.svgwidth-r-e,n=+this.svgheight-t-a,o=this.svg.append("g").attr("transform","translate("+r+","+t+")"),l=w.scaleBand().rangeRound([0,i]).padding(.1),s=w.scaleLinear().rangeRound([n,0]);return l.domain(this.xaxisdata.map(function(t){return t.label})),s.domain([0,w.max(this.yaxisdata,function(t){return t.value})]),1==this.deviceQueryService.IsDesktop()?o.append("g").attr("transform","translate(0,"+n+")").attr("color","grey").call(w.axisBottom(l)):o.append("g").attr("transform","translate(0,"+n+")").attr("color","grey").call(w.axisBottom(l)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),o.append("g").attr("color","grey").call(w.axisLeft(s)),{g:o,x:l,y:s,height:n,width:i}},t.prototype.plotScale=function(t,e,a,r,i){this.vScale&&t.append("g").attr("color","lightgrey").attr("transform","translate(0,"+r+")").call(w.axisBottom(e).tickSize(-this.width).tickFormat("")),this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.legendClick=function(t){var a=this,e={};e.label=t.label;var r=[];t.data.forEach(function(t){var e={};e[t.legend]=t.value,e[a.xaxisname]=t.label,r.push(e)}),e.data=r,this.onLegendClick.emit(e)},t.propDecorators={hScale:[{type:n.Input,args:["horizontal-scale"]}],vScale:[{type:n.Input,args:["vertical-scale"]}],httpurl:[{type:n.Input,args:["data"]},{type:n.Input,args:["http-url"]}],httpmethod:[{type:n.Input,args:["http-method"]}]},t}(l),y=function(r){function t(t,e){var a=r.call(this,t)||this;return a.deviceQueryService=t,a.myservice=e,a.level=0,a.labelflag=!1,a.labelcolor="black",a.drillabledatakey=[],a.drillableFlag=!0,a.resizeflag=!1,a}return o(t,r),t.prototype.ngOnInit=function(){var e,t=this;this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t},function(t){},function(){setTimeout(function(){t.data=t.getResponseData(e),t.plotD3Chart()},0)}):this.data&&setTimeout(function(){t.data=t.getResponseData(t.data),t.plotD3Chart()},0))},t.prototype.fetchData=function(t){var e,a,r=this,i=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,i):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a=t},function(t){},function(){setTimeout(function(){r.data=r.getResponseData(a),r.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.plotD3Chart()},0)},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.plotD3Chart()},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.plotD3Chart=function(){0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var t=this.toolTip(w),e=this.initChart();this.plotScale(e.g,e.x,e.y,e.height,e.width),this.plotLine(e.g,e.x,e.y,e.height,e.width,[],t,1);for(var a=0;a<this.multiseriesdata.length;a++)this.plotLine(e.g,e.x,e.y,e.height,e.width,this.multiseriesdata[a],t,a+1)},t.prototype.plotLine=function(t,a,r,e,i,n,o,l){var s=this,h=w.line().x(function(t){return a(t.label)}).y(function(t){return r(t.value)});t.append("path").datum(n).attr("fill","none").attr("stroke",this.predefinedcolors[l]).attr("stroke-width",1.5).attr("d",h),t.selectAll("dot").data(n).enter().append("circle").attr("cx",function(t){return a(t.label)}).attr("cy",function(t){return r(t.value)}).attr("r",2).attr("cursor","pointer").on("mouseover",function(t){return o.style("visibility","visible")}).on("mousemove",function(t){return o.html(s.callTooltip(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return o.style("visibility","hidden")}).on("click",function(t){return s.lineChartClick(t),s.fordrillableClick(s,t,event),o.style("visibility","hidden")}),this.labelflag&&t.selectAll("label").data(n).enter().append("text").style("font-weight","bold").attr("text-anchor","middle").attr("fill",function(t){return 0<s.labelcolor.length?s.labelcolor:"black"}).attr("x",function(t,e){return a(t.label)}).attr("y",function(t,e){return r(t.value)-10}).text(function(t){return t.value})},t.prototype.lineChartClick=function(t){var e={};e[t.legend]=t.value,e[this.xaxisname]=t.label,this.chartClick(e)},t.prototype.callTooltip=function(t){var e={};return e[t.legend]=t.value,e[this.xaxisname]=t.label,this.toolTipForBar(e)},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-line",template:'\n<div *ngIf="drillableFlag" #divid (window:resize)="resize()"> \n<table style="width: 100%;" #chartId  >\n        <tr><td style="font-size: 18px; font-weight: bold; "> {{title}} </td></tr>\n        <tr>\n            <td>\n                <svg [attr.height]="height" [attr.width]="svgwidth" [attr.id]="componentId">\n                </svg>            \n            </td>\n        </tr>\n        <tr>\n            <td style="display: block; padding: 5px;">\n                    <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="legendClick($event)" \n                                        [data]="legends" style="height:100%;">\n                    </amexio-d3-legend>\n            </td>\n        \n        </tr>\n</table>\n</div>\n    '}]}],t.ctorParameters=function(){return[{type:p},{type:s}]},t.propDecorators={chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],drillid:[{type:n.ViewChild,args:["drillid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],labelflag:[{type:n.Input,args:["label"]}],labelcolor:[{type:n.Input,args:["label-color"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}]},t}(f),g=function(r){function t(t,e){var a=r.call(this,"barstack")||this;return a.myservice=t,a.device=e,a.maxYValue=0,a.barwidth=0,a.labelflag=!1,a.title="",a.legend=!0,a.labelcolor="black",a.color=[],a.svgwidth=300,a.level=0,a.drillabledatakey=[],a.hScale=!0,a.drillableFlag=!0,a.resizeflag=!1,a.svgheight=300,a.onLegendClick=new n.EventEmitter,a}return o(t,r),t.prototype.ngOnInit=function(){var e=this;this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e.httpresponse=t,e.data=e.getResponseData(t)},function(t){},function(){setTimeout(function(){e.transformData(e.data),e.plotChart()},0)}):this.data1&&setTimeout(function(){e.transformData(e.data1),e.plotChart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.data=t.getResponseData(t.httpresponse),t.transformData(t.data),t.plotChart()},0)},t.prototype.transformData=function(t){var e,s=this;this.keyArray=[],this.legendArray=[],t.forEach(function(t,e){0==e&&t.forEach(function(t,e){0<e?(s.legendArray[t]={data:[]},s.keyArray.push(t)):0==e&&(s.xaxis=t)})}),e=[],t.forEach(function(i,t){if(0<t){var n={};i.forEach(function(t,e){if(0<=e){var a=s.keyArray[e-1];n[a]=i[e];var r=s.legendArray[a];r&&r.data.push({value:i[e],label:i[0]})}}),e.push(n)}}),this.data=[],e.forEach(function(t){s.data.push(t)});var h=0,d=[];this.data.forEach(function(t){var e,a,r=function(e,a){s.keyArray.forEach(function(t){e==t&&(h+=a)})};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2);r(o[0],o[1])}}catch(l){e={error:l}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}d.push(h),h=0});var a;for(a=0;a<d.length;a++)0<d[a]&&(this.maxYValue=d[a]);this.legends=[],this.keyArray.forEach(function(t,e){var a=s.legendArray[t];if(0<s.color.length){var r={label:t,color:s.color[e],data:a.data};s.legends.push(r)}else{r={label:t,color:s.predefinedcolors[e],data:a.data};s.legends.push(r)}})},t.prototype.plotChart=function(){var t,a=this,e=this.toolTip(w),r=20,i=30,n=90,o=60,l=this.predefinedcolors;this.device.IsDesktop()&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth),t=this.data;var s=[];if(this.httpmethod&&this.httpurl){try{for(var h=C(Object.entries(this.data[0])),d=h.next();!d.done;d=h.next()){var c=D(d.value,2),p=c[0];c[1];s.push(p)}}catch(k){m={error:k}}finally{try{d&&!d.done&&(b=h["return"])&&b.call(h)}finally{if(m)throw m.error}}this.keyArray=s,this.keyArray.splice(0,1)}var u=w.stack().keys(this.keyArray).offset(w.stackOffsetDiverging)(this.data);this.svg=w.select("#"+this.componentId);var f,y=this.svgwidth-o-i;f=this.device.IsDesktop()?(this.offsetheight=this.chartId.nativeElement.offsetHeight,this.offsetheight):this.chartId.nativeElement.offsetHeight-10;var g=w.scaleBand().domain(t.map(function(t){return t[Object.keys(t)[0]]})).rangeRound([o,y-i]).padding(.35),v=w.scaleLinear().domain([w.min(this.stackMin(u)),this.maxYValue]).rangeRound([f-n,r]);1==this.device.IsDesktop()?this.svg.append("g").attr("transform","translate(0,"+v(0)+")").call(w.axisBottom(g)):this.svg.append("g").attr("transform","translate(0,"+v(0)+")").call(w.axisBottom(g)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),this.svg.append("g").attr("transform","translate("+o+",0)").call(w.axisLeft(v)),this.plotLine(this.svg,g,v,f,y,o);var m,b,x=this.svg.append("g").selectAll("g").data(u).enter().append("g").attr("fill",function(t,e){return 0<a.color.length&&a.color[e]?a.color[e]:l[e]}).selectAll("rect").data(function(t){return t});x.enter().append("rect").attr("width",g.bandwidth()).attr("id",function(t,e){return t.data[e]}).attr("x",function(t){return g(+t.data[Object.keys(t.data)[0]])}).attr("y",function(t,e){return v(t[1])}).attr("cursor","pointer").attr("height",function(t,e){return v(t[0])-v(t[1])}).on("mouseover",function(t){return e.style("visibility","visible")}).on("mousemove",function(t){return e.html(a.setKey(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return e.style("visibility","hidden")}).on("click",function(t){return a.setBarClickText(t),a.fordrillableClick(a,t,event),e.style("visibility","hidden")}),this.labelflag&&x.enter().append("text").style("font-weight","bold").style("font-size","1vw").attr("text-anchor","middle").attr("fill",function(t){return 0<a.labelcolor.length?a.labelcolor:"black"}).attr("x",function(t){return g(+t.data[Object.keys(t.data)[0]])+g.bandwidth()/2}).attr("y",function(t,e){return v(t[1])+20}).text(function(t){return t[Object.keys(t)[1]]-t[Object.keys(t)[0]]})},t.prototype.stackMin=function(t){return w.min(t,function(t){return t[0]})},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.plotChart()},t.prototype.plotLine=function(t,e,a,r,i,n){this.hScale&&t.append("g").attr("transform","translate("+n+",0)").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.legendClick=function(t){var e={};e.label=t.label;var a=[];t.data.forEach(function(t){var e={};e[t.label]=t.value,a.push(e)}),e.data=a,this.onLegendClick.emit(e)},t.prototype.setKey=function(t){var e,a,r=t[0]-t[1];r<0&&(r*=-1);try{for(var i=C(Object.entries(t.data)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];if(s==r){var h={};return h[l]=s,h[this.xaxis]=t.data[Object.keys(t.data)[0]],this.toolTipForBar(h)}}}catch(d){e={error:d}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}},t.prototype.setBarClickText=function(t){var e=t[0]-t[1];e<0&&(e*=-1);var a,r,i={};try{for(var n=C(Object.entries(t.data)),o=n.next();!o.done;o=n.next()){var l=D(o.value,2),s=l[0],h=l[1];h==e&&(i[s]=h,i[this.xaxis]=t.data[Object.keys(t.data)[0]])}}catch(d){a={error:d}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(a)throw a.error}}this.chartClick(i)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-barstack",template:'<div   *ngIf="drillableFlag" #divid (window:resize)="resize()">\n<table style="width: 100%;" #chartId  (window:resize)="resize()">\n  <tr><td style="font-size: 18px; font-weight: bold; "> {{title}} </td></tr>\n  <tr>\n      <td>\n          <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n          </svg>            \n      </td>\n  </tr>\n  <tr>\n      <td style="display: block; padding: 5px;">\n              <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="legendClick($event)" \n                                  [data]="legends" style="height:100%;">\n              </amexio-d3-legend>\n      </td>\n  \n  </tr>\n</table>\n</div>',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={data1:[{type:n.Input,args:["data"]}],barwidth:[{type:n.Input}],labelflag:[{type:n.Input,args:["label"]}],title:[{type:n.Input}],legend:[{type:n.Input}],labelcolor:[{type:n.Input,args:["label-color"]}],color:[{type:n.Input}],svgwidth:[{type:n.Input,args:["width"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}],svgheight:[{type:n.Input,args:["height"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],drillid:[{type:n.ViewChild,args:["drillid"]}],onLegendClick:[{type:n.Output}]},t}(l),v=function(r){function t(t,e){var a=r.call(this,"multibar")||this;return a.myservice=t,a.device=e,a.legend=!0,a.barwidth=0,a.labelcolor="black",a.labelflag=!1,a.onLegendClick=new n.EventEmitter,a.svgwidth=300,a.svgheight=300,a.level=0,a.drillabledatakey=[],a.hScale=!0,a.drillableFlag=!0,a.resizeflag=!1,a.groupbarchartArray=[],a.urllegendArray=[],a.predefinedcolors=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"],a}return o(t,r),t.prototype.ngOnInit=function(){var e,t=this;this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t},function(t){},function(){setTimeout(function(){t.data=t.getResponseData(e),t.initializeData(),t.plotD3Chart()},0)}):this.data&&setTimeout(function(){t.data=t.getResponseData(t.data),t.initializeData(),t.plotD3Chart()},0))},t.prototype.fetchData=function(t){var e,a,r=this,i=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,i):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a=t},function(t){},function(){setTimeout(function(){r.data=r.getResponseData(a),r.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.initializeData(),t.plotD3Chart()},0)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.plotD3Chart=function(){this.convertToJSON(),this.plotGroupBarChart(),this.transformData(this.data)},t.prototype.plotGroupBarChart=function(){var e=this,a=this.toolTip(w),r=this.predefinedcolors;0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var t=20,i=20,n=50,o=40,l=this.svgwidth-o-i,s=this.svgheight-t-n;this.svg=w.select("#"+this.componentId).attr("width",l+o+i).attr("height",s+t+n).append("g").attr("transform","translate("+o+","+t+")");var h=w.scaleBand().rangeRound([0,l]).padding(.2),d=w.scaleBand().padding(.1),c=w.scaleLinear().rangeRound([s,0]);this.years=this.groupbarchartArray.map(function(t){return t.labels});var p=this.groupbarchartArray[0].values.map(function(t){return t.label});h.domain(this.years),d.domain(p).rangeRound([0,h.bandwidth()]),c.domain([0,w.max(this.groupbarchartArray,function(t){return w.max(t.values,function(t){return t.value})})]),0<this.barwidth?this.barwidth=this.barwidth:this.barwidth=h.bandwidth,1==this.device.IsDesktop()?this.svg.append("g").attr("transform","translate(0,"+s+")").call(w.axisBottom(h)):this.svg.append("g").attr("transform","translate(0,"+s+")").call(w.axisBottom(h)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),this.svg.append("g").call(w.axisLeft(c).ticks(10)),this.plotLine(this.svg,c,s,l);var u=this.svg.selectAll(".slice").data(this.groupbarchartArray).enter().append("g").attr("class","g").attr("transform",function(t){return"translate("+h(t.labels)+",0)"});u.selectAll("rect").data(function(t){return t.values}).enter().append("rect").attr("width",d.bandwidth).attr("x",function(t){return d(t.label)}).style("fill",function(t,e){return r[e]}).attr("y",function(t){return c(0)}).attr("height",function(t){return s-c(0)}).attr("cursor","pointer").on("mouseover",function(t){return a.style("visibility","visible")}).on("mousemove",function(t){return a.html(e.setKey(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return a.style("visibility","hidden")}).on("click",function(t){return e.groupbarClick(t),e.fordrillableClick(e,t,event),a.style("visibility","hidden")}),this.labelflag&&u.selectAll("text").data(function(t){return t.values}).enter().append("text").attr("width",d.bandwidth).attr("x",function(t){return d(t.label)+d.bandwidth()/2}).attr("y",function(t){return c(t.value)}).attr("height",function(t){return s-c(0)}).style("font-weight","bold").style("font-size","1vw").attr("text-anchor","middle").attr("fill",function(t){return 0<e.labelcolor.length?e.labelcolor:"black"}).text(function(t){return t.value}),u.selectAll("rect").attr("y",function(t){return c(t.value)}).attr("height",function(t){return s-c(t.value)})},t.prototype.groupbarClick=function(t){var e={};e[t.label]=t.value,e[this.xaxisData]=t.xaxis,this.chartClick(e)},t.prototype.resize=function(t){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.plotGroupBarChart()},t.prototype.legendClick=function(t){var e={};e.label=t.label;var a=[];t.data.forEach(function(t){var e={};e[t.label]=t.value,a.push(e)}),e.data=a,this.onLegendClick.emit(e)},t.prototype.convertToJSON=function(){var t={labels:"",values:[]},e=this.data[0];this.xaxisData=this.data[0][0];for(var a=1;a<this.data.length;a++){for(var r=[],i=void 0,n=1;n<this.data[a].length;n++){i=this.data[a][0];var o={};o.value=this.data[a][n],o.label=e[n],o.xaxis=this.data[a][0],r.push(o)}if(r.length){t.values=r;var l=i,s=Object.assign({},t);s.labels=l+"",this.groupbarchartArray.push(s)}}},t.prototype.transformto2dArray=function(){var r=this,a=[];a.push("years"),this.data.forEach(function(t,e){0==e&&t.values.forEach(function(t){a.push(t.label)})}),this.urllegendArray.push(a);var i=[];this.data.forEach(function(t){var e;i=[];var a=t.labels;i.push(a),t.values.forEach(function(t){e=t.value,i.push(e)}),r.urllegendArray.push(i)})},t.prototype.transformData=function(t){var o=this;this.keyArray=[],this.legendArray=[],t.forEach(function(t,e){0==e&&t.forEach(function(t,e){0<e&&(o.legendArray[t]={data:[]},o.keyArray.push(t))})}),t.forEach(function(i,t){if(0<t){var n={};i.forEach(function(t,e){if(0<=e){var a=o.keyArray[e-1];n[a]=i[e];var r=o.legendArray[a];r&&r.data.push({value:i[e],label:i[0]})}})}}),this.legends=[],this.keyArray.forEach(function(t,e){var a=o.legendArray[t],r={label:t,color:o.predefinedcolors[e],data:a.data};o.legends.push(r)})},t.prototype.setKey=function(t){var e={};return e[t.label]=t.value,e[this.xaxisData]=t.xaxis,this.toolTipForBar(e)},t.prototype.plotLine=function(t,e,a,r){this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(e).tickSize(-r).tickFormat(""))},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-multiseries",template:'<div   *ngIf="drillableFlag" #divid (window:resize)="resize($event)"> \n<table style="width: 100%;" #chartId>\n    <tr>\n        <td colspan="2" style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n    </tr>\n    <tr>\n        <td>\n            <svg [attr.height]="height" [attr.width]="width" [attr.id]="componentId">\n            </svg>\n        </td>\n    </tr>\n    <tr>\n        <td style="display: block; padding: 5px;">\n            <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="legendClick($event)" [data]="legends" style="height:100%;"></amexio-d3-legend>\n        </td>\n    </tr>\n</table>\n</div>\n\n\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],drillid:[{type:n.ViewChild,args:["drillid"]}],data:[{type:n.Input,args:["data"]}],legend:[{type:n.Input}],barwidth:[{type:n.Input}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}],onLegendClick:[{type:n.Output}],svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}]},t}(l),m=function(r){function t(t,e){var a=r.call(this,"combochart")||this;return a.myservice=t,a.device=e,a.svgwidth=300,a.svgheight=300,a.lineColor="black",a.horizontal=!1,a.level=0,a.drillabledatakey=[],a.hScale=!0,a.drillableFlag=!0,a.resizeflag=!1,a.colorflag=!1,a.keyArray=[],a.transformeddata=[],a.legendArray=[],a}return o(t,r),t.prototype.ngOnInit=function(){var e,a=this;this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t,a.httpresponse=t},function(t){},function(){setTimeout(function(){a.data=a.getResponseData(e),a.transformData(a.data),a.initializeData(),a.plotD3Chart()},0)}):this.data&&setTimeout(function(){a.data=a.getResponseData(a.data),a.transformData(a.data),a.initializeData(),a.plotD3Chart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.data=t.getResponseData(t.httpresponse),t.transformData(t.data),t.initializeData(),t.plotD3Chart()},0)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.plotD3Chart=function(){var e=this;this.formLegendData(),0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var a=this.lineInput,r=this.toolTip(w);this.svg=w.select("#"+this.componentId);var i,n,o,t=20,l=20,s=85,h=60,d=this.svgwidth-h-l;console.log("offsetheight",this.offsetheight),i=1==this.device.IsDesktop()?(this.offsetheight=this.chartId.nativeElement.offsetHeight-20-90,this.offsetheight):this.svgheight-t-s;var c=this.svg.append("g").attr("transform","translate("+h+","+t+")");if(0==this.horizontal){n=w.scaleBand().rangeRound([0,d]).padding(.1),o=w.scaleLinear().rangeRound([i,0]),n.domain(this.data.map(function(t){return t[Object.keys(t)[0]]}));var p=w.max(this.data,function(t){return t[Object.keys(t)[1]]}),u=w.max(this.data,function(t){return t[e.lineInput]}),f=void 0;f=u<p?p:u,o.domain([0,f]),1==this.device.IsDesktop()?c.append("g").attr("transform","translate(0,"+i+")").call(w.axisBottom(n)):c.append("g").attr("transform","translate(0,"+i+")").call(w.axisBottom(n)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(65)").style("text-anchor","start"),c.append("g").call(w.axisLeft(o).ticks(10)),this.plotLine(c,n,o,i,d),c.selectAll(".bar").data(this.data).enter().append("rect").attr("class","bar").attr("x",function(t){return n(t[Object.keys(t)[0]])}).attr("y",function(t){return o(t[Object.keys(t)[1]])}).attr("cursor","pointer").attr("width",n.bandwidth()).attr("height",function(t){return i-o(t[Object.keys(t)[1]])}).style("fill",function(t){return t.color}).on("mouseover",function(t){return r.style("visibility","visible")}).on("mousemove",function(t){return r.html(e.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return r.style("visibility","hidden")}).on("click",function(t){return e.barChartClick(t),e.fordrillableClick(e,t,event),r.style("visibility","hidden")});var y=w.line().x(function(t){return n(t[Object.keys(t)[0]])}).y(function(t){return o(t[a])}),g=h+n.bandwidth()/2;this.svg.append("path").data([this.data]).attr("fill","none").style("stroke",this.lineColor).attr("stroke-width",1.5).attr("transform","translate( "+g+", 20 )").attr("d",y);var v=this.svg.selectAll("circle.point1").data(this.data);v.enter().append("circle").merge(v).attr("class","point1").attr("cursor","pointer").style("stroke",this.lineColor).style("fill",this.lineColor).attr("cx",function(t){return n(t[Object.keys(t)[0]])}).attr("cy",function(t){return o(t[a])}).attr("r",function(t){return 5}).attr("transform","translate( "+g+", 20 )").on("mouseover",function(t){return r.style("visibility","visible")}).on("mousemove",function(t){return r.html(e.formTooltipLineData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return r.style("visibility","hidden")}).on("click",function(t){return e.onComboLineClick(t),e.fordrillableClick(e,t,event),r.style("visibility","hidden")})}},t.prototype.plotLine=function(t,e,a,r,i){this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.formTooltipData=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return this.toolTipForBar(r)},t.prototype.transformData=function(t){var r=this;this.transformeddata=[],this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}}),this.data=this.transformeddata},t.prototype.formLegendData=function(){var a=this;this.legendArray=[],this.data.forEach(function(t){var e={};e.label=t[Object.keys(t)[0]],e.value=t[Object.keys(t)[1]],e.color=t.color,a.legendArray.push(e)})},t.prototype.onBarLegendClick=function(t){var e={};e[this.keyArray[0]]=t.label,e[this.keyArray[1]]=t.value,this.legendClick(e)},t.prototype.barChartClick=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}this.chartClick(r)},t.prototype.onComboLineClick=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}this.comboLineClick(r)},t.prototype.formTooltipLineData=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];l==this.lineInput&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return this.toolTipForBar(r)},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.plotD3Chart()},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-combochart",template:'<div *ngIf="drillableFlag" #divid (window:resize)="resize()">\n<table style="width: 100%;" #chartId >\n  <tr>\n      <td style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n  </tr>\n  <tr>\n      <td>\n          <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n          </svg>\n      </td>\n  </tr>\n  <tr>\n      <td style="display: block; padding: 5px;">\n          <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="onBarLegendClick($event)" [data]="legendArray" style="height:100%;">\n          </amexio-d3-legend>\n      </td>\n  </tr>\n</table>\n</div>',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],lineColor:[{type:n.Input,args:["line-color"]}],horizontal:[{type:n.Input}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],lineInput:[{type:n.Input,args:["line-data-index"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}]},t}(l),b=function(r){function t(t,e){var a=r.call(this,"histogram")||this;return a.myservice=t,a.device=e,a.svgwidth=300,a.svgheight=400,a.color="blue",a.labelflag=!1,a.labelcolor="black",a.hScale=!0,a.level=0,a.drillabledatakey=[],a.resizeflag=!1,a.drillableFlag=!0,a.values=[],a.array=[],a.xaxisArray=[],a.yaxisArray=[],a.yaxisData=[],a.histogramarray=[],a.histogramdata=[],a.lengtharray=[],a.arrayofLength=[],a.chartData=[],a.finaldataarray=[],a.tooltipArray=[],a.index=0,a}return o(t,r),t.prototype.ngOnInit=function(){var e,a=this;this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t,a.httpresponse=t},function(t){},function(){setTimeout(function(){a.datahisto=[],a.datahisto=a.getResponseData(e),a.transformData(),a.plotXaxis(),a.plotYaxis(),a.tooltipData(),a.dataforChart(),a.transformData1(a.finaldataarray),a.plotChart()},0)}):this.datahisto&&setTimeout(function(){a.datahisto=a.getResponseData(a.datahisto),a.transformData(),a.plotXaxis(),a.plotYaxis(),a.tooltipData(),a.dataforChart(),a.transformData1(a.finaldataarray),a.plotChart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.datahisto=t.getResponseData(t.httpresponse),t.transformData(),t.plotXaxis(),t.plotYaxis(),t.tooltipData(),t.dataforChart(),t.transformData1(t.finaldataarray),t.plotChart()},0)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.transformData1=function(t){var e,o=this;this.keyArray=[],this.legendArray=[],t.forEach(function(t,e){0==e&&t.forEach(function(t,e){0<e?(o.legendArray[t]={data:[]},o.keyArray.push(t)):0==e&&(o.xaxis=t)})}),e=[],t.forEach(function(i,t){if(0<t){var n={};i.forEach(function(t,e){if(0<=e){var a=o.keyArray[e-1];n[a]=i[e];var r=o.legendArray[a];r&&r.data.push({value:i[e],label:i[0]})}}),e.push(n)}}),this.data=[],e.forEach(function(t){o.data.push(t)}),this.legends=[];var a=this.datahisto[0],r={label:a[1]+" of "+a[0],color:this.color};this.legends.push(r)},t.prototype.plotChart=function(){var t,a=this,r=this.toolTip(w);this.data,t=w.stack().keys(this.keyArray).offset(w.stackOffsetDiverging)(this.data);var e,i=0;e=[],(e=t).forEach(function(t){t.forEach(function(t){var e=[];e.push(t.data.tooltipdata[i]),t.push(e)}),i++});var n=[];for(i=0;i<e.length-1;i++)n.push(e[i]);0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var o,l,s=20,h=20,d=50,c=60,p=this.svgwidth-c-h,u=this.svgheight-s-d;this.svg=w.select("#"+this.componentId).attr("width",p+c+h).attr("height",u+s+d).append("g").attr("transform","translate("+c+","+s+")");var f=p/this.chartData.length;o=w.scalePoint().domain(this.xaxisArray,function(t){return t}).rangeRound([0,p]),(l=w.scaleLinear().rangeRound([u,0])).domain([0,w.max(this.arrayofLength)]);w.scaleOrdinal(w.schemeCategory10);this.arrayofLength=[],1==this.device.IsDesktop()?this.svg.append("g").attr("transform","translate(0,"+u+")").call(w.axisBottom(o)):this.svg.append("g").attr("transform","translate(0,"+u+")").call(w.axisBottom(o)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start");this.svg.append("g").call(w.axisLeft(l)),this.plotLine(this.svg,o,l,u,p);var y=this.svg.append("g").selectAll("g").data(n).enter().append("g").attr("fill",this.color).selectAll("rect").data(function(t){return t}),g=this.svg.append("g").selectAll("g").data(n).enter().append("g").selectAll("labels").data(function(t){return t});y.enter().append("rect").attr("width",f-1).attr("y",function(t,e){return l(t[1])}).attr("cursor","pointer").attr("height",function(t,e){return Math.abs(l(t[0])-l(t[1]-.05))}).attr("transform",function(t,e){return"translate("+[f*e,0]+")"}).on("mouseover",function(t){return r.style("visibility","visible")}).on("mousemove",function(t){var e=t[2];return r.html(a.setKey(e[0])).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return r.style("visibility","hidden")}).on("click",function(t){var e=t[2];return a.histogramClick(e[0]),a.fordrillableClick(a,t,event),r.style("visibility","hidden")}),this.labelflag&&g.enter().append("text").style("font-weight","bold").attr("text-anchor","middle").attr("fill",function(t){return 0<a.labelcolor.length?a.labelcolor:"black"}).attr("y",function(t,e){return l(t[1])}).text(function(t){var e;return(e=t[2][0])?e.value:null}).attr("transform",function(t,e){return"translate("+[f*e+f/2,Math.abs(l(t[0])-l(t[1]-.05))]+")"})},t.prototype.histogramClick=function(t){var e={},a=this.datahisto[0],r=a[1],i=a[0];t.label.length&&(e[i+":"]=t.label,e[r+":"]=t.value),this.chartClick(e)},t.prototype.legendClick=function(t){this.onLegendClick.emit(this.datahisto)},t.prototype.transformData=function(){var e=this;this.array=[],this.values=[],this.datahisto.forEach(function(t){e.values.push(t[1])});for(var t=1;t<this.values.length;t++)this.array.push(this.values[t])},t.prototype.plotXaxis=function(){this.xaxisArray=[],this.xaxisArray.push(0);for(var t=0,e=Math.ceil(w.max(this.array)),a=(e=e%10==0?e:10-e%10+e)/5;t<e;)t+=a,this.xaxisArray.push(t)},t.prototype.plotYaxis=function(){var a=this,r=0,i=0,t=0,e=0;this.yaxisArray=[],this.histogramarray=[],this.lengtharray=[],this.histogramdata=[],this.arrayofLength=[],this.chartData=[],this.xaxisArray.forEach(function(e){a.yaxisArray=[],a.array.forEach(function(t){r<t&&t<=e&&a.yaxisArray.push(t),i=a.yaxisArray.length}),t=i<t?t:i,r=e,a.lengtharray.push(i)});for(var n=Math.ceil(t),o=n/5;e<=n;)e+=o,this.yaxisData.push(e);for(var l=1;l<this.histogramarray.length;l++)this.histogramdata.push(this.histogramarray[l]);for(l=1;l<this.lengtharray.length;l++)this.arrayofLength.push(this.lengtharray[l]);for(l=0;l<this.arrayofLength.length;l++){var s={};s.value=this.arrayofLength[l],this.chartData.push(s)}this.array=[]},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.transformData(),this.plotXaxis(),this.plotYaxis(),this.tooltipData(),this.dataforChart(),this.transformData1(this.finaldataarray),this.plotChart()},t.prototype.dataforChart=function(){this.finaldataarray=[];var t=[],e=[];t.push("level");for(var a=Math.max.apply(null,this.arrayofLength),r=a,i=1;i<=a;)t.push(""+i),i++;t.push("tooltipdata");this.arrayofLength.length;var n=0;this.finaldataarray.push(t);for(var o=0;o<this.arrayofLength.length;o++){var l=this.arrayofLength[o],s=l;if((e=[]).push(""+o),a=r,0<l){for(;0!=l;)e.push(1),l--;for(a-=s;0!=a;)e.push(0),a--}else for(;0!=a;)e.push(0),a--;e.push(this.tooltipArray[n]),this.finaldataarray.push(e),n++}},t.prototype.tooltipData=function(){var e=[],a={label:"",value:""};this.datahisto.forEach(function(t){(a={label:"",value:""}).label=t[0],a.value=t[1],e.push(a)});for(var r=this.xaxisArray[0],i=[],t=function(t){i=[];var a=n.xaxisArray[t];e.forEach(function(t){if(r<=t.value&&t.value<=a){var e={label:"",value:""};e.label=t.label,e.value=t.value,i.push(e)}}),n.tooltipArray.push(i),r=a},n=this,o=1;o<this.xaxisArray.length;o++)t(o)},t.prototype.setKey=function(t){var e={},a=this.datahisto[0],r=a[1];return e[a[0]+":"]=t.label,e[r+":"]=t.value,this.toolTipForBar(e)},t.prototype.plotLine=function(t,e,a,r,i){this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-histogram",template:'<div   *ngIf="drillableFlag" #divid (window:resize)="resize()" >\n<table style="width: 100%;" #chartId >\n        <tr>\n            <td colspan="2" style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n        </tr>\n        <tr>\n            <td>\n                <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n                </svg>\n            </td>\n        </tr>\n        <tr>\n            <td style="display: block; padding: 5px;">\n                <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="legendClick($event)" [data]="legends" style="height:100%;"></amexio-d3-legend>\n            </td>\n        </tr>\n    </table>\n</div>\n',styles:[".bar{background-color:#3943cf;padding:.02px}"]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],color:[{type:n.Input,args:["color"]}],datahisto:[{type:n.Input,args:["data"]}],labelflag:[{type:n.Input,args:["label"]}],labelcolor:[{type:n.Input,args:["label-color"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}]},t}(l),x=function(r){function t(t,e){var a=r.call(this,"scatter")||this;return a.myservice=t,a.device=e,a.svgwidth=300,a.svgheight=300,a.color="blue",a.labelcolor="black",a.labelflag=!1,a.level=0,a.drillabledatakey=[],a.hScale=!0,a.vScale=!0,a.drillableFlag=!0,a.resizeflag=!1,a.keyArray=[],a.transformeddata=[],a.legendarray=[],a}return o(t,r),t.prototype.ngOnInit=function(){var e,a=this;(this.dataFormatted=[],this.level<=1)&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t,a.httpresponse=e},function(t){},function(){setTimeout(function(){a.data=a.getResponseData(e),a.dataFormatted=a.data,a.transformData(a.dataFormatted),a.colorGeneration(),a.legendCreation(),a.plotScatterChart()},0)}):this.data&&setTimeout(function(){a.dataFormatted=a.data,a.data=a.getResponseData(a.data),a.transformData(a.data),a.colorGeneration(),a.legendCreation(),a.plotScatterChart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.data=t.getResponseData(t.httpresponse),t.dataFormatted=t.data,t.transformData(t.data),t.colorGeneration(),t.legendCreation(),t.plotScatterChart()},0)},t.prototype.transformData=function(t){var r=this;this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}}),this.data=this.transformeddata},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.plotScatterChart=function(){var e=this;0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var a,r,i=this.toolTip(w),t=20,n=20,o=30,l=60,s=this.svgwidth-l-n,h=this.svgheight-t-o;a=w.scaleLinear().rangeRound([0,s]),r=w.scaleLinear().rangeRound([h,0]);var d=w.axisBottom(a),c=w.axisLeft(r);this.svg=w.select("#"+this.componentId).attr("width",s+l+n).attr("height",h+t+o).append("g").attr("transform","translate("+l+","+t+")"),a.domain([0,w.max(this.data,function(t){return t[Object.keys(t)[0]]})]),r.domain([0,w.max(this.data,function(t){return t[Object.keys(t)[1]]})]),1==this.device.IsDesktop()?this.svg.append("g").attr("transform","translate(0,"+h+")").call(d).append("text").attr("y",0).attr("x",9).attr("dy",".35em").style("text-anchor","start"):this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(d).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),this.svg.append("g").attr("class","y axis").call(c).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),2==this.dataFormatted[0].length?(this.plotLine(this.svg,a,r,h,s),this.svg.selectAll(".dot").data(this.data).enter().append("circle").attr("class","dot").attr("fill",this.color).attr("r",4.5).attr("cursor","pointer").attr("cx",function(t){return a(t[Object.keys(t)[0]])}).attr("cy",function(t){return r(t[Object.keys(t)[1]])}).on("mouseover",function(t){return i.style("visibility","visible")}).on("mousemove",function(t){return i.html(e.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return i.style("visibility","hidden")}).on("click",function(t){return e.scatterChartClick(t),e.fordrillableClick(e,t,event),i.style("visibility","hidden")}),this.labelflag&&this.svg.selectAll("labels").data(this.data).enter().append("text").style("font-weight","bold").attr("text-anchor","middle").attr("vertical-align","middle").attr("margin-top",t).attr("fill",function(t){return 0<e.labelcolor.length?e.labelcolor:"black"}).attr("x",function(t,e){return a(t[Object.keys(t)[0]])+11}).attr("y",function(t,e){return r(t[Object.keys(t)[1]])}).text(function(t){return t[Object.keys(t)[1]]})):(this.plotLine(this.svg,a,r,h,s),this.svg.selectAll(".dot").data(this.transformeddata).enter().append("circle").attr("class","dot").attr("r",4.5).attr("cursor","pointer").attr("cx",function(t){return a(t[Object.keys(t)[0]])}).attr("cy",function(t){return r(t[Object.keys(t)[1]])}).attr("fill",function(t){return t[Object.keys(t)[4]]}).on("mouseover",function(t){return i.style("visibility","visible")}).on("mousemove",function(t){return i.html(e.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return i.style("visibility","hidden")}).on("click",function(t){return e.scatterChartClick(t),e.fordrillableClick(e,t,event),i.style("visibility","hidden")}),this.labelflag&&this.svg.selectAll("labels").data(this.data).enter().append("text").style("font-weight","bold").attr("text-anchor","middle").attr("vertical-align","middle").attr("margin-top",t).attr("fill",function(t){return 0<e.labelcolor.length?e.labelcolor:"black"}).attr("x",function(t,e){return a(t[Object.keys(t)[0]])+11}).attr("y",function(t,e){return r(t[Object.keys(t)[1]])}).text(function(t){return t[Object.keys(t)[1]]}))},t.prototype.formTooltipData=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return this.toolTipForBar(r)},t.prototype.scatterChartClick=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];r[l]=s}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}this.chartClick(r)},t.prototype.legendCreation=function(){var a=this;if(2==this.dataFormatted[0].length){this.legends=[];var t=this.dataFormatted[0],e={label:t[0]+" vs "+t[1],color:this.color};this.legends.push(e)}else this.legends=[],this.legendarray.forEach(function(t){var e={};e.label=t.label,e.color=t.color,a.legends.push(e)})},t.prototype.onScatterLegendClick=function(e){var a=this;2==this.dataFormatted[0].length?this.onLegendClick.emit(this.data):this.legendarray.forEach(function(t){e.label==t.label&&a.legendClick(t.value)})},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.plotScatterChart()},t.prototype.plotLine=function(t,e,a,r,i){this.vScale&&t.append("g").attr("color","lightgrey").attr("transform","translate(0,"+r+")").call(w.axisBottom(e).tickSize(-this.width).tickFormat("")),this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.colorGeneration=function(){var r=this;this.legendarray=[];for(var i=0,n=this.dataFormatted.map(function(t){return t[2]}).filter(function(t,e,a){return a.indexOf(t)===e}),t=function(e){var a=[],t={label:"",color:"",value:[]};o.transformeddata.forEach(function(t){t[Object.keys(t)[2]]==n[e]&&(t.color=r.predefinedcolors[i],a.push(t))}),t.value=a,t.label=n[e],t.color=o.predefinedcolors[i],o.legendarray.push(t),i++},o=this,e=1;e<n.length;e++)t(e)},t.prototype.formLegendData=function(){var a=this;this.legendData=[],this.legendarray.forEach(function(t){var e={};e.label=t.label,e.color=t.color,a.legendData.push(e)})},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-scatter",template:'<div *ngIf="drillableFlag" #divid (window:resize)="resize()">\n    <table style="width: 100%;" #chartId >\n        <tr>\n            <td colspan="2" style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n        </tr>\n        <tr>\n            <td>\n                <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n                </svg>\n            </td>\n        </tr>\n        <tr>\n            <td style="display: block; padding: 5px;">\n                <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="onScatterLegendClick($event)" [data]="legends" style="height:100%;"></amexio-d3-legend>\n            </td>\n        </tr>\n    </table>\n</div>',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],color:[{type:n.Input,args:["color"]}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}],vScale:[{type:n.Input,args:["vertical-scale"]}]},t}(l),k=function(r){function t(t,e){var a=r.call(this,"areachart")||this;return a.myservice=t,a.device=e,a.svgwidth=300,a.svgheight=350,a.level=0,a.labelcolor="black",a.labelflag=!1,a.drillabledatakey=[],a.drillableFlag=!0,a.resizeflag=!1,a.togglelabel=!1,a.onLegendClick=new n.EventEmitter,a.onTooltipClick=new n.EventEmitter,a.hScale=!0,a.margin={},a.keyArray=[],a.transformeddata=[],a.data1=[],a.legendArray=[],a}return o(t,r),t.prototype.ngOnInit=function(){var e=this;this.togglelabel=!1,this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e.httpresponse=t,e.data=e.getResponseData(t)},function(t){},function(){setTimeout(function(){e.transformData(e.data),e.initAreaChart(),e.plotD3Chart()},0)}):this.data1&&setTimeout(function(){e.transformData(e.data),e.initAreaChart(),e.plotD3Chart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.data=t.getResponseData(t.httpresponse),t.transformData(t.data),t.initAreaChart(),t.plotD3Chart()},0)},t.prototype.initAreaChart=function(){this.tooltip=this.toolTip(w),0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth),this.margin={top:30,right:44,bottom:50,left:30},this.width=this.svgwidth-this.margin.left-this.margin.right,this.height=this.svgheight-this.margin.top-this.margin.bottom,this.maximumValue=this.findMaxData(this.data),this.x=w.scalePoint().range([0,this.width]),this.y=w.scaleLinear().rangeRound([this.height,0]),this.areaArray=[],this.areaArray=this.data.map(function(t){return t[Object.keys(t)[0]]}),this.x.domain(this.areaArray),this.y.domain([0,this.maximumValue]),this.svg=w.select("#"+this.componentId).attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom),this.predefinedColors=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"]},t.prototype.plotD3Chart=function(){var t;this.formLegendData();var e,a=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")");for(1==this.device.IsDesktop()?a.append("g").attr("transform","translate(0,"+this.height+")").call(w.axisBottom(this.x)):a.append("g").attr("transform","translate(0,"+this.height+")").call(w.axisBottom(this.x)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),a.append("g").call(w.axisLeft(this.y)),this.plotLine(a,this.x,this.y,this.height,this.width),t=1;t<this.keyArray.length;t++){var r=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")");this.plotAreaChart(r,t,this)}for(e=1;e<this.keyArray.length;e++){r=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")");this.PlotLineDot(r,e,this)}},t.prototype.PlotLineDot=function(t,a,r){var e=this,i=this.togglelabel,n=w.line().x(function(t){return r.x(t[Object.keys(t)[0]])}).y(function(t){return r.y(t[Object.keys(t)[a]])});t.append("path").data([r.data]).attr("fill","none").attr("stroke",r.predefinedcolors[a]).attr("stroke-width",1.5).attr("d",n).attr("opacity",.2).attr("transform","translate(0,0)"),t.selectAll("dot").data(r.data).enter().append("circle").attr("opacity",0).attr("fill",r.predefinedcolors[a]).attr("cx",function(t){return r.x(t[Object.keys(t)[0]])}).attr("cy",function(t){return r.y(t[Object.keys(t)[a]])}).attr("r",4).attr("cursor","pointer").on("mouseover",function(t){return e.formTooltipData(t,a),e.tooltip.style("visibility","visible")}).on("mousemove",function(t){return e.tooltip.html(e.formTooltipData(t,a)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return e.tooltip.style("visibility","hidden")}).style("opacity",1).on("click",function(t){return e.onAreaTooltipClick(t,a),e.fordrillableClick(e,t,event),e.tooltip.style("visibility","hidden")}).attr("transform","translate(0,0)"),this.labelflag&&t.selectAll("labels").data(r.data).enter().append("text").style("font-weight","bold").attr("text-anchor","middle").attr("fill",function(t){return 0<e.labelcolor.length?e.labelcolor:"black"}).attr("x",function(t){return r.x(t[Object.keys(t)[0]])+20}).attr("y",function(t){var e=[Object.keys(t)[a]];return i?r.y(t[e])-5:r.y(t[e])+15}).text(function(t){return t[Object.keys(t)[a]]}).attr("transform","translate(0,0)"),this.togglelabel?this.togglelabel=!1:this.togglelabel=!0},t.prototype.plotAreaChart=function(t,a,r){var e=w.line().x(function(t){var e=[Object.keys(t)[0]];return r.x(t[e])}).y(function(t){var e=[Object.keys(t)[a]];return r.y(t[e])});t.append("path").data([this.data]).style("stroke",this.predefinedColors[a]).attr("fill","none").style("stroke-width","2px").attr("d",e).attr("transform","translate(0,0)");var i=w.area().x(function(t){var e=[Object.keys(t)[0]];return r.x(t[e])}).y0(this.height).y1(function(t){var e=[Object.keys(t)[a]];return r.y(t[e])});t.append("path").data([this.data]).attr("d",i).attr("transform","translate(0,0)").style("stroke","none").attr("fill",this.predefinedColors[a]).style("opacity",.5)},t.prototype.onAreaTooltipClick=function(t,e){var a={};a[this.keyArray[0]]=t[Object.keys(t)[0]],a[this.keyArray[e]]=t[Object.keys(t)[e]],this.chartClick(a)},t.prototype.findMaxData=function(t){var d=this,c=[],p=[];return t.forEach(function(t){var e,a,r;try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];l!=d.keyArray[0]&&c.push(s)}}catch(h){a={error:h}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(a)throw a.error}}e=d.findLargestValue(c),p.push(e)}),this.findLargestValue(p)},t.prototype.findLargestValue=function(t){var e,a=0;for(e=0;e<t.length;e++)t[e]>a&&(a=t[e]);return a},t.prototype.transformData=function(t){var r=this;this.transformeddata=[],this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}});var e=JSON.parse(JSON.stringify(this.transformeddata));this.data=e},t.prototype.formLegendData=function(){var r=this;this.legendArray=[],this.keyArray.forEach(function(t,e){if(0<e){var a={};a.label=t,a.color=r.predefinedColors[e+1],r.legendArray.push(a)}})},t.prototype.onAreaLegendClick=function(d){var c=this,t={};t.label=d.label;var p=[];this.data.forEach(function(t){try{for(var e=C(Object.entries(c.data[0])),a=e.next();!a.done;a=e.next()){var r=D(a.value,2),i=r[0],n=r[1];if(i==d.label){var o={};o[i]=n,p.push(o)}}}catch(h){l={error:h}}finally{try{a&&!a.done&&(s=e["return"])&&s.call(e)}finally{if(l)throw l.error}}var l,s}),t.data=p,this.onLegendClick.emit(t)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.initAreaChart(),this.plotD3Chart()},t.prototype.formTooltipData=function(t,e){var a={};return a[this.keyArray[0]]=t[Object.keys(t)[0]],a[this.keyArray[e]]=t[Object.keys(t)[e]],this.toolTipForBar(a)},t.prototype.plotLine=function(t,e,a,r,i){this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-multiarea",template:'\n<div  *ngIf="drillableFlag" #divid (window:resize)="resize()">\n<table style="width: 100%;" #chartId>\n  <tr>\n      <td style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n  </tr>\n  <tr>\n      <td>\n          <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n          </svg>\n      </td>\n  </tr>\n  <tr>\n      <td style="display: block; padding: 5px;">\n          <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="onAreaLegendClick($event)" [data]="legendArray" style="height:100%;">\n          </amexio-d3-legend>\n      </td>\n  </tr>\n</table>\n</div>',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],onLegendClick:[{type:n.Output}],onTooltipClick:[{type:n.Output}],hScale:[{type:n.Input,args:["horizontal-scale"]}]},t}(l),I=function(r){function t(t,e){var a=r.call(this,"candlestickwaterfallchart")||this;return a.myservice=t,a.device=e,a.svgwidth=300,a.svgheight=300,a.level=0,a.drillabledatakey=[],a.labelcolor="black",a.labelflag=!1,a.hScale=!0,a.onLegendClick=new n.EventEmitter,a.drillableFlag=!0,a.resizeflag=!1,a.predefinedColor=[],a.keyArray=[],a.margin={},a.legendArray=[],a}return o(t,r),t.prototype.ngOnInit=function(){var e=this;this.predefinedColor=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"],this.level<=1&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e.httpresponse=t,e.data=e.getResponseData(t)},function(t){},function(){setTimeout(function(){e.transformData(e.data),e.initializeData(),e.plotXYAxis(),e.plotD3Chart()},0)}):this.data&&setTimeout(function(){e.transformData(e.data),e.initializeData(),e.plotXYAxis(),e.plotD3Chart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.data=t.getResponseData(t.httpresponse),t.transformData(t.data),t.initializeData(),t.plotXYAxis(),t.plotD3Chart()},0)},t.prototype.initializeData=function(){this.tooltip=this.toolTip(w),0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth),this.margin={top:20,right:30,bottom:50,left:60},this.width=this.svgwidth-this.margin.left-this.margin.right,this.height=this.svgheight-this.margin.top-this.margin.bottom},t.prototype.plotXYAxis=function(){this.x=w.scaleBand().range([0,this.width]),this.y=w.scaleLinear().rangeRound([this.height,0]);var t=this.data.map(function(t){return t[Object.keys(t)[0]]});this.x.domain(t);var e=w.max(this.data,function(t){return t.end});this.y.domain([0,e]),this.svg=w.select("#"+this.componentId).attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),1==this.device.IsDesktop()?this.svg.append("g").attr("transform","translate(0,"+this.height+")").call(w.axisBottom(this.x)):this.svg.append("g").attr("transform","translate(0,"+this.height+")").call(w.axisBottom(this.x)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),this.svg.append("g").call(w.axisLeft(this.y)),this.plotLine(this.svg,this.x,this.y,this.height,this.width)},t.prototype.plotD3Chart=function(){var a=this,t=this.svg.selectAll(".bar").data(this.data).enter().append("g").attr("class",function(t){return"bar "+t["class"]}).attr("transform",function(t){return"translate("+a.x(t[Object.keys(t)[0]])+",0)"});t.append("rect").attr("y",function(t){return a.y(Math.max(t.start,t.end))}).attr("height",function(t){return Math.abs(a.y(t.start)-a.y(t.end))}).attr("width",this.x.bandwidth()).attr("fill",function(t,e){return a.predefinedColor[e]}).attr("cursor","pointer").on("mouseover",function(t){return a.formTooltipData(t),a.tooltip.style("visibility","visible")}).on("mousemove",function(t){return a.tooltip.html(a.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return a.tooltip.style("visibility","hidden")}).on("click",function(t){return a.onCandlestickClick(t),a.fordrillableClick(a,t,event),a.tooltip.style("visibility","hidden")}),this.labelflag&&t.append("text").style("font-weight","bold").style("font-size","1vw").attr("text-anchor","middle").attr("fill",function(t){return 0<a.labelcolor.length?a.labelcolor:"black"}).attr("x",function(t){return a.x.bandwidth()/2}).attr("y",function(t,e){return a.y(Math.max(t.start,t.end))+20}).text(function(t){return t[Object.keys(t)[1]]})},t.prototype.plotLine=function(t,e,a,r,i){this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.transformData=function(t){var r=this;this.transformeddata=[],this.keyArray=[],this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}}),this.data=this.transformeddata,this.addDataKeys(),this.formLegendData()},t.prototype.addDataKeys=function(){for(var t=0,e=0;e<this.data.length;e++)this.data[e].start=t,t+=this.data[e][this.keyArray[1]],this.data[e].end=t,this.data[e]["class"]=0<=this.data[e][this.keyArray[1]]?"positive":"negative"},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.formTooltipData=function(t){var e={};return e[this.keyArray[0]]=t[Object.keys(t)[0]],e[this.keyArray[1]]=t[Object.keys(t)[1]],this.toolTipForBar(e)},t.prototype.onCandlestickClick=function(t){var e={};e[this.keyArray[0]]=t[Object.keys(t)[0]],e[this.keyArray[1]]=t[Object.keys(t)[1]],this.chartClick(e)},t.prototype.formLegendData=function(){var c=this;this.legendArray=[],this.data.forEach(function(t,e){try{for(var a=C(Object.entries(t)),r=a.next();!r.done;r=a.next()){var i=D(r.value,2),n=i[0],o=i[1];if(n==c.keyArray[0]){var l={};l.label=o,l.color=c.predefinedColor[e],c.legendArray.push(l)}}}catch(d){s={error:d}}finally{try{r&&!r.done&&(h=a["return"])&&h.call(a)}finally{if(s)throw s.error}}var s,h})},t.prototype.onCandlestickLegendClick=function(l){var s={};this.data.forEach(function(t){try{for(var e=C(Object.entries(t)),a=e.next();!a.done;a=e.next()){var r=D(a.value,2);r[0];r[1]==l.label&&(s[l.label]=t.value)}}catch(o){i={error:o}}finally{try{a&&!a.done&&(n=e["return"])&&n.call(e)}finally{if(i)throw i.error}}var i,n}),this.onLegendClick.emit(s)},t.prototype.resize=function(){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.initializeData(),this.plotXYAxis(),this.plotD3Chart()},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-waterfall",template:'\n<div   *ngIf="drillableFlag" #divid (window:resize)="resize()" >\n<table style="width: 100%;" #chartId (window:resize)="resize()">\n  <tr>\n      <td style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n  </tr>\n  <tr>\n      <td>\n          <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n          </svg>\n      </td>\n  </tr>\n  <tr>\n      <td style="display: block; padding: 5px;">\n          <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="onCandlestickLegendClick($event)" [data]="legendArray" style="height:100%;">\n          </amexio-d3-legend>\n      </td>\n  </tr>\n</table>\n</div>',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],datareader:[{type:n.Input,args:["data-reader"]}],data:[{type:n.Input}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],labelcolor:[{type:n.Input,args:["label-color"]}],labelflag:[{type:n.Input,args:["label"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],onLegendClick:[{type:n.Output}]},t}(l),A=function(i){function t(t,e,a){var r=i.call(this,"bubble")||this;return r.myservice=t,r.cdf=e,r.device=a,r.svgwidth=300,r.svgheight=300,r.color="blue",r.level=0,r.drillabledatakey=[],r.hScale=!0,r.vScale=!0,r.drillableFlag=!0,r.resizeflag=!1,r.keyArray=[],r.transformeddata=[],r.colors=[],r.xaxisArray=[],r.xarray=[],r.legends=[],r.legendarray=[],r.legendData=[],r.minxvalue=0,r.maxxvalue=0,r.bubblechartdata=[],r.predefinedcolors=["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"],r}return o(t,i),t.prototype.ngOnInit=function(){var e,a=this;(this.data1=[],this.level<=1)&&(this.httpmethod&&this.httpurl?this.myservice.fetchUrlData(this.httpurl,this.httpmethod).subscribe(function(t){e=t,a.httpresponse=e},function(t){},function(){setTimeout(function(){a.data=a.getResponseData(e),a.data1=a.data,a.xaxisData(),a.transformData(a.data1),a.transformdata(),a.colorGeneration(),a.formLegendData(),a.plotBubbleChart()},0)}):this.data&&setTimeout(function(){a.data1=a.data,a.data=a.getResponseData(a.data),a.xaxisData(),a.transformData(a.data),a.transformdata(),a.colorGeneration(),a.formLegendData(),a.plotBubbleChart()},0))},t.prototype.fetchData=function(t){var e,a=this,r=this.drillabledatakey;this.drillabledatakey.length?e=this.getMultipleDrillbleKeyData(t,r):e=t;this.httpmethod&&this.httpurl&&this.myservice.postfetchData(this.httpurl,this.httpmethod,e).subscribe(function(t){a.httpresponse=t},function(t){},function(){setTimeout(function(){a.drawChart()},0)})},t.prototype.drawChart=function(){var t=this;setTimeout(function(){t.data=t.getResponseData(t.httpresponse),t.data1=t.data,t.xaxisData(),t.transformData(t.data1),t.transformdata(),t.colorGeneration(),t.formLegendData(),t.plotBubbleChart()},0)},t.prototype.getResponseData=function(t){var e,a,r=t;if(null!=this.datareader){var i=this.datareader.split(".");try{for(var n=C(i),o=n.next();!o.done;o=n.next()){r=r[o.value]}}catch(l){e={error:l}}finally{try{o&&!o.done&&(a=n["return"])&&a.call(n)}finally{if(e)throw e.error}}}else r=t;return r},t.prototype.transformData=function(t){var r=this;this.colordata=[],this.keyArray=t[0],t.forEach(function(t,e){if(0<e){var a={};t.forEach(function(t,e){a[r.keyArray[e]]=t}),r.transformeddata.push(a)}}),this.data=this.transformeddata,this.colordata=this.transformeddata},t.prototype.plotBubbleChart=function(){var e=this;this.predefinedcolors;0==this.resizeflag&&(this.chartId?this.svgwidth=this.chartId.nativeElement.offsetWidth:this.svgwidth=this.svgwidth);var a,r,i=this.toolTip(w),t=20,n=60,o=50,l=60,s=this.svgwidth-l-n,h=this.svgheight-t-o;a=w.scaleLinear().rangeRound([0,s]),r=w.scaleLinear().rangeRound([h,0]);var d=w.axisBottom(a),c=w.axisLeft(r);this.svg=w.select("#"+this.componentId).attr("width",s+l+n).attr("height",h+t+o).append("g").attr("transform","translate("+l+","+t+")"),r.domain([0,w.max(this.data,function(t){return t[Object.keys(t)[2]]})]),a.domain([this.minxvalue,this.maxxvalue]);var p=w.scaleSqrt().rangeRound([6,30]);p.domain([w.min(this.data,function(t){return t[Object.keys(t)[4]]}),w.max(this.data,function(t,e){return t[Object.keys(t)[4]]})]),1==this.device.IsDesktop()?this.svg.append("g").attr("transform","translate(0,"+h+")").call(d).append("text").attr("y",0).attr("x",9).attr("dy",".35em").style("text-anchor","start"):this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(d).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(60)").style("text-anchor","start"),this.svg.append("g").attr("class","y axis").call(c).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),this.plotLine(this.svg,a,r,h,s);this.svg.selectAll(".dot").data(this.bubblechartdata).enter().append("circle").attr("class","dot").attr("r",function(t){return p(t[Object.keys(t)[4]])}).attr("cursor","pointer").attr("cx",function(t){return a(t[Object.keys(t)[1]])}).attr("cy",function(t){return r(t[Object.keys(t)[2]])}).attr("fill",function(t){return t[Object.keys(t)[5]]}).attr("opacity",.7).on("mouseover",function(t){return i.style("visibility","visible")}).on("mousemove",function(t){return i.html(e.formTooltipData(t)).style("top",w.event.pageY-10+"px").style("left",w.event.pageX+10+"px")}).on("mouseout",function(t){return i.style("visibility","hidden")}).on("click",function(t){return e.bubbleChartClick(t),e.fordrillableClick(e,t,event),i.style("visibility","hidden")})},t.prototype.formTooltipData=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];"color"!=l&&(r[l]=s)}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}return this.toolTipForBar(r)},t.prototype.bubbleChartClick=function(t){var e,a,r={};try{for(var i=C(Object.entries(t)),n=i.next();!n.done;n=i.next()){var o=D(n.value,2),l=o[0],s=o[1];r[l]=s}}catch(h){e={error:h}}finally{try{n&&!n.done&&(a=i["return"])&&a.call(i)}finally{if(e)throw e.error}}this.chartClick(r)},t.prototype.resize=function(t){this.svgwidth=0,this.svg.selectAll("*").remove(),this.resizeflag=!0,this.svgwidth=this.divid.nativeElement.offsetWidth,this.plotBubbleChart()},t.prototype.xaxisData=function(){var e=[];this.minxvalue=0,this.maxxvalue=0,this.xaxisArray=[],this.xarray=[],this.data1.forEach(function(t){e.push(t[1])});for(var t=1;t<e.length;t++)this.xaxisArray.push(e[t]);var a=Math.floor(w.min(this.xaxisArray)),r=Math.ceil(w.max(this.xaxisArray));this.minxvalue=5*Math.floor(Math.abs(a/5)),this.maxxvalue=5*Math.ceil(Math.abs(r/5))},t.prototype.colorGeneration=function(){var r=this;this.legendarray=[];for(var i=0,n=this.data1.map(function(t){return t[3]}).filter(function(t,e,a){return a.indexOf(t)===e}),t=function(e){var a=[],t={label:"",color:"",value:[]};o.colordata.forEach(function(t){t[Object.keys(t)[3]]==n[e]&&(t.color=r.predefinedcolors[i],a.push(t))}),t.value=a,t.label=n[e],t.color=o.predefinedcolors[i],o.legendarray.push(t),i++},o=this,e=1;e<n.length;e++)t(e)},t.prototype.formLegendData=function(){var a=this;this.legendData=[],this.legendarray.forEach(function(t){var e={};e.label=t.label,e.color=t.color,a.legendData.push(e)})},t.prototype.onBubbleLegendClick=function(e){var a=this;this.legendarray.forEach(function(t){e.label==t.label&&a.legendClick(t.value)})},t.prototype.plotLine=function(t,e,a,r,i){this.vScale&&t.append("g").attr("color","lightgrey").attr("transform","translate(0,"+r+")").call(w.axisBottom(e).tickSize(-this.width).tickFormat("")),this.hScale&&t.append("g").attr("color","lightgrey").call(w.axisLeft(a).tickSize(-i).tickFormat(""))},t.prototype.transformdata=function(){var a=this;this.bubblechartdata=[];var r=[];this.colordata.forEach(function(t,e){r.push(t[Object.keys(t)[4]])});for(var i=r.sort(function(t,e){return e-t}),t=function(e){n.colordata.forEach(function(t){i[e]==t[Object.keys(t)[4]]&&a.bubblechartdata.push(t)})},n=this,e=0;e<=i.length;e++)t(e)},t.decorators=[{type:n.Component,args:[{selector:"amexio-d3-chart-bubble",template:'\n<div   *ngIf="drillableFlag" #divid (window:resize)="resize($event)">\n<table style="width: 100%;" #chartId >\n  <tr>\n      <td colspan="2" style="font-size: 18px; font-weight: bold; "> {{title}} </td>\n  </tr>\n  <tr>\n      <td>\n          <svg [attr.height]="svgheight" [attr.width]="svgwidth" [attr.id]="componentId">\n          </svg>\n      </td>\n  </tr>\n  <tr>\n      <td style="display: block; padding: 5px;">\n          <amexio-d3-legend *ngIf="legend" [horizontal]="true" (onClick)="onBubbleLegendClick($event)" [data]="legendData" style="height:100%;"></amexio-d3-legend>\n      </td>\n  </tr>\n</table>\n</div>',styles:[""]}]}],t.ctorParameters=function(){return[{type:s},{type:n.ChangeDetectorRef},{type:p}]},t.propDecorators={svgwidth:[{type:n.Input,args:["width"]}],svgheight:[{type:n.Input,args:["height"]}],color:[{type:n.Input,args:["color"]}],chartId:[{type:n.ViewChild,args:["chartId"]}],divid:[{type:n.ViewChild,args:["divid"]}],datareader:[{type:n.Input,args:["data-reader"]}],level:[{type:n.Input,args:["level"]}],target:[{type:n.Input,args:["target"]}],drillabledatakey:[{type:n.Input,args:["drillable-data"]}],hScale:[{type:n.Input,args:["horizontal-scale"]}],vScale:[{type:n.Input,args:["vertical-scale"]}]},t}(l),L=function(){function t(){}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){return this.getComponentData()},t.prototype.getComponentData=function(){return this.chartInputArray=[],this.barchartinput=this.queryBarchartinput.toArray(),this.groupbarchartinput=this.QueryGroupbarchartinput.toArray(),this.linechartinput=this.QueryLinechartinput.toArray(),this.donutchartinput=this.QueryDonutchartinput.toArray(),this.piechartinput=this.QueryPiechartinput.toArray(),this.barstackchartinput=this.QueryBarStackchartinput.toArray(),this.combochartinput=this.QueryCombochartinput.toArray(),this.histogramchartinput=this.QueryHistogramchartinput.toArray(),this.scatterchartinput=this.QuerySatterchartinput.toArray(),this.multiareachartinput=this.QueryMultiareachartinput.toArray(),this.candlestickchartinput=this.QueryCandlestickchartinput.toArray(),this.bubblechartinput=this.QueryBubblechartinput.toArray(),this.chartInputArray=this.chartInputArray.concat(this.barchartinput,this.groupbarchartinput,this.linechartinput,this.donutchartinput,this.piechartinput,this.barstackchartinput,this.combochartinput,this.histogramchartinput,this.scatterchartinput,this.multiareachartinput,this.candlestickchartinput,this.bubblechartinput),this.chartInputArray},t.propDecorators={queryBarchartinput:[{type:n.ContentChildren,args:[u,{descendants:!0}]}],QueryGroupbarchartinput:[{type:n.ContentChildren,args:[v,{descendants:!0}]}],QueryLinechartinput:[{type:n.ContentChildren,args:[y,{descendants:!0}]}],QueryPiechartinput:[{type:n.ContentChildren,args:[d,{descendants:!0}]}],QueryDonutchartinput:[{type:n.ContentChildren,args:[h,{descendants:!0}]}],QueryBarStackchartinput:[{type:n.ContentChildren,args:[g,{descendants:!0}]}],QueryCombochartinput:[{type:n.ContentChildren,args:[m,{descendants:!0}]}],QueryHistogramchartinput:[{type:n.ContentChildren,args:[b,{descendants:!0}]}],QuerySatterchartinput:[{type:n.ContentChildren,args:[x,{descendants:!0}]}],QueryMultiareachartinput:[{type:n.ContentChildren,args:[k,{descendants:!0}]}],QueryCandlestickchartinput:[{type:n.ContentChildren,args:[I,{descendants:!0}]}],QueryBubblechartinput:[{type:n.ContentChildren,args:[A,{descendants:!0}]}]},t}(),O=function(e){function t(){var t=e.call(this)||this;return t.mouseLocation={left:0,top:0},t.componentcounter=1,t.disableFlag=!1,t}return o(t,e),t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){this.ComponentDataArray=this.getComponentData(),this.getData(this.ComponentDataArray)},t.prototype.getData=function(t){var e=this;t.forEach(function(t){1!==t.level?(t.drillableFlag=!1,t.drillableEvent.subscribe(function(t){e.hideUI(t),e.sameLevelChart(t),e.ShowUI(t)})):(e.disableFlag=!1,t.drillableEvent.subscribe(function(t){e.hideUI(t),e.sameLevelChart(t),e.ShowUI(t)}))})},t.prototype.hideUI=function(e){this.ComponentDataArray.forEach(function(t){t.level==e.ref.level&&(e.ref.drillableFlag=!1)})},t.prototype.ShowUI=function(e){var a=this;this.eventData=[],this.eventData=e,this.ComponentDataArray.forEach(function(t){e.ref.target==t.level&&(1==a.arrayofsameLevel.length?(a.disableFlag=!0,t.drillableFlag=!0,t.fetchData(e.node),a.componentcounter=t.level):(a.contextmenuFlag=!0,a.mouseLocation.left=e.event.clientX,a.mouseLocation.top=e.event.clientY,a.contextStyle=a.getContextMenuStyle()))}),this.componentcounter==e.ref.level&&(e.ref.drillableFlag=!0)},t.prototype.previouschartClick=function(t){var e=this,a=this.componentcounter-1;this.ComponentDataArray.forEach(function(t){a==t.level?(t.drillableFlag=!0,t.drawChart()):e.componentcounter==t.level&&(t.drillableFlag=!1)}),2==this.componentcounter&&(this.disableFlag=!1),this.componentcounter=a},t.prototype.sameLevelChart=function(e){var a=this;this.arrayofsameLevel=[],this.ComponentDataArray.forEach(function(t){e.ref.target==t.level&&(a.arrayofsameLevel=a.arrayofsameLevel.concat(t))})},t.prototype.getContextMenuStyle=function(){return{cursor:"default",position:"fixed",display:this.contextmenuFlag?"block":"none",left:this.mouseLocation.left+"px",top:this.mouseLocation.top+"px","box-shadow":"1px 1px 2px #000000",width:"15%"}},t.prototype.getListPosition=function(t){return window.screen.height-t.getBoundingClientRect().bottom<240},t.prototype.onContextNodeClick=function(t){this.componentcounter=0,this.contextmenuFlag=!1,this.eventData.ref.drillableFlag=!1,this.disableFlag=!0,t.drillableFlag=!0,t.fetchData(this.eventData.node),this.componentcounter=t.level,this.componentcounter==this.eventData.ref.level&&(this.eventData.ref.drillableFlag=!0)},t.prototype.onCloseClick=function(){this.contextmenuFlag=!1},t.decorators=[{type:n.Component,args:[{selector:"amexio-drillable",template:'\n<div > \n    <ng-container *ngIf="disableFlag">\n            <button type="button" class="button"\n             (click)="previouschartClick($event)">\n             <i class="fa fa-arrow-left"></i> \n             \n            </button>\n</ng-container>\n\n<ng-content></ng-content>\n\n</div>\n\n<span [ngStyle]="contextStyle" >\n  <ul *ngIf="contextmenuFlag" class="close-thik" class="context-menu-list"  >\n    <span (click)="onCloseClick()" class="close"><i class="fa fa-close"></i></span>\n  <li (click)="onContextNodeClick(itemConfig)" class="context-menu-list-items" \n  *ngFor="let itemConfig of arrayofsameLevel">\n  <em [ngStyle]="{\'padding-left\': itemConfig.icon ? \'5px\':\'19px\'}"></em>\n  <span style="white-space: nowrap;display: inline ; padding-left:5px">{{itemConfig.title}}\n  </span>\n  </li>\n  </ul>\n  </span>\n  ',styles:['.button{position:relative;border:1px solid #555;font-weight:400;color:#000;padding:.5rem 1rem;text-align:center;transition-duration:.4s;text-decoration:none;overflow:hidden;cursor:pointer;border-radius:3px}.button:after{content:"";background:#000;display:block;position:absolute;padding-top:300%;padding-left:350%;margin-left:-20px!important;margin-top:-120%;opacity:0;transition:.8s}.button:active:after{padding:0;margin:0;opacity:1;transition:none}.context-menu-list{display:block;position:absolute;flex-direction:column;min-width:180px;cursor:pointer;max-height:150px;z-index:1;padding:10px 0;overflow-y:auto;background-color:#fff!important;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.context-menu-list .context-menu-list-items{text-decoration:none;font-size:14px!important;padding:5px;display:block}.close{float:right;padding-right:8px;cursor:pointer}']}]}],t.ctorParameters=function(){return[]},t}(L),z=[c,h,u,d,y,g,v,m,O,b,k,x,I,A],E=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[e.FormsModule,a.CommonModule],declarations:z,providers:[p],exports:z}]}],t}();t.AmexioChartD3Module=E,t.AmexioD3DounutChartComponent=h,t.AmexioD3PieChartComponent=d,t.AmexioD3BarChartComponent=u,t.AmexioD3LineComponent=y,t.BarstackComponent=g,t.GroupbarComponent=v,t.a=z,t.c=l,t.i=L,t.n=A,t.m=I,t.g=m,t.h=O,t.j=b,t.b=c,t.f=f,t.l=k,t.k=x,t.d=s,t.e=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=amexio-chart-d3.umd.min.js.map